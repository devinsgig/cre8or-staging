import{S as U}from"./SkeletonPostsList-68921a0e.js";import{a7 as W,bE as E,bF as N,j as D,b0 as H,b1 as z,b2 as R,m as p,p as v,bG as q,ad as g,bH as F,bI as T,bJ as G,_ as M,y as V,u as O,al as B,ak as J,V as Q,r as l,o as i,g as h,w as _,b as a,d as n,$ as m,c as u,e as S,t as b,h as L,Q as c,l as I,aB as Y,L as K,F as P,f as X,b4 as Z,aC as $}from"../../assets/app-8df99815.js";import{P as ee}from"./PostDetailModal-69941281.js";import{P as te}from"./PostContent-93850f8e.js";const oe={components:{Error:W,VideoPlayerShort:E,ContentWarningWrapper:N,BaseIcon:D,Avatar:H,UserName:z,ContentHtml:R},props:{item:{type:Object,default:null},showMenuAction:{type:Boolean,default:!0},autoPlay:{type:Boolean,default:!1}},data(){return{isContentWarning:!!(this.item.content_warning_categories.length&&this.item.showContentWarning),loadingLike:!1,loadingUnlike:!1,loadingBookmark:!1,loadingUnbookmark:!1}},computed:{...p(V,["authenticated","user"]),...p(O,["setOpenedModalCount"]),...p(B,["showVibbComment"]),buttonActionStyle(){return"w-11 h-11 p-base-2 bg-white rounded-full dark:bg-dark-web-wash"},songItem(){return this.item.items[1]},vibbItem(){return this.item.items[0]}},watch:{item:{handler:function(){this.isContentWarning=!!(this.item.content_warning_categories.length&&this.item.showContentWarning)},deep:!0}},methods:{...v(J,["toggleLikePostItem","toggleBookmarkPostItem"]),...v(Q,["setSelectedPage"]),...v(B,["setShowVibbComment"]),async likePost(s){if(this.authenticated){if(this.loadingLike)return;this.loadingLike=!0;try{await this.toggleLikePostItem({subject_type:"posts",subject_id:s,action:"add"}),this.$refs.likeButton.classList.add("active")}catch(t){this.showError(t.error)}finally{this.loadingLike=!1}}else this.showRequireLogin()},async unLikePost(s){if(!this.loadingUnlike){this.loadingUnlike=!0;try{await this.toggleLikePostItem({subject_type:"posts",subject_id:s,action:"remove"}),this.$refs.likeButton.classList.remove("active")}catch(t){this.showError(t.error)}finally{this.loadingUnlike=!1}}},async bookmarkPost(s){if(this.authenticated){if(this.loadingBookmark)return;this.loadingBookmark=!0;try{await this.toggleBookmarkPostItem({subject_type:"posts",subject_id:s,action:"add"}),this.$refs.bookmarkButton.classList.add("active")}catch(t){this.showError(t.error)}finally{this.loadingBookmark=!1}}else this.showRequireLogin()},async unBookmarkPost(s){if(!this.loadingUnbookmark){this.loadingUnbookmark=!0;try{await this.toggleBookmarkPostItem({subject_type:"posts",subject_id:s,action:"remove"}),this.$refs.bookmarkButton.classList.remove("active")}catch(t){this.showError(t.error)}finally{this.loadingUnbookmark=!1}}},openLikersModal(s,t){this.setOpenedModalCount(),this.$dialog.open(q,{data:{itemType:s,itemId:t},props:{header:this.$t("Likes"),class:"likers-modal",modal:!0,dismissableMask:!0,draggable:!1},onClose:()=>{g(),this.setOpenedModalCount(!1)}})},openShareModal(s,t){this.authenticated?(this.setOpenedModalCount(),this.$dialog.open(F,{data:{subjectType:s,subject:t},props:{showHeader:!1,class:"dropdown-menu-modal",modal:!0,dismissableMask:!0,draggable:!1},onClose:()=>{g(),this.setOpenedModalCount(!1)}})):this.showRequireLogin()},openDropdownMenu(){this.setOpenedModalCount(),this.$dialog.open(T,{data:{post:this.item},props:{showHeader:!1,class:"dropdown-menu-modal",modal:!0,dismissableMask:!0,draggable:!1},onClose:()=>{g(),this.setOpenedModalCount(!1)}})},handleOpenVibbModal(){this.openVibb({vibb:this.item})},handleOpenPostAnalytics(){this.authenticated?(this.setOpenedModalCount(),this.$dialog.open(G,{data:{post:this.item},props:{header:this.$t("Post Analytics"),modal:!0,dismissableMask:!0,draggable:!1},onClose:()=>{g(),this.setOpenedModalCount(!1)}})):this.showRequireLogin()},handleCommentVibb(){this.handleOpenVibbModal(),this.setShowVibbComment(!this.showVibbComment)}}},se=["id"],ae={class:"flex gap-base-2 items-center mb-base-1"},ne={key:0,class:"bg-black text-white px-2 py-1 text-xs rounded-lg inline-flex items-center gap-1 mt-base-1"},ie={class:"absolute bottom-3 end-3 hidden md:flex flex-col gap-5 z-20"},le={class:"flex flex-col items-center gap-1"},re={class:"text-base-xs font-semibold text-white"},de={class:"text-base-xs font-semibold text-white"};function me(s,t,e,x,y,o){const k=l("VideoPlayerShort"),f=l("Avatar"),w=l("UserName"),C=l("ContentHtml"),r=l("BaseIcon"),A=l("ContentWarningWrapper"),j=l("Error");return e.item?(i(),h(A,{key:0,"content-warning-list":e.item.content_warning_categories,post:e.item,class:"h-full rounded-none md:rounded-base-lg"},{default:_(()=>[a("div",{class:"relative pb-[100%] cursor-pointer",onClick:t[8]||(t[8]=(...d)=>o.handleOpenVibbModal&&o.handleOpenVibbModal(...d))},[a("div",{class:"absolute inset-0",id:`vibbItem-${e.item.id}`},[n(k,{ref:"vibbFeedRef",video:o.vibbItem.subject,autoPlay:e.autoPlay,"allow-pip":!1,"allow-toggle-play":!1,"show-progress-bar":!1,"is-content-warning":y.isContentWarning,class:"w-full h-full rounded-none md:rounded-base-lg overflow-hidden z-20"},null,8,["video","autoPlay","is-content-warning"]),a("div",{class:"absolute start-3 bottom-3 end-16 text-white max-h-1/3 overflow-y-auto scrollbar-hidden z-20",onClick:t[0]||(t[0]=m(()=>{},["stop"]))},[a("div",ae,[n(f,{user:e.item.user,border:!1,activePopover:!1,tab:"vibbs"},null,8,["user"]),n(w,{user:e.item.user,activePopover:!1,tab:"vibbs"},null,8,["user"])]),n(C,{content:e.item.content,mentions:e.item.mentions,limit:100},null,8,["content","mentions"]),o.songItem?(i(),u("span",ne,[n(r,{name:"music_note",size:"16"}),S(" "+b(o.songItem.subject.name),1)])):L("",!0)]),a("div",ie,[a("div",le,[a("button",{ref:"likeButton",class:c(["feed-main-action-like",e.item.is_liked?"text-base-red is-liked":"",o.buttonActionStyle]),onClick:t[1]||(t[1]=m(d=>e.item.is_liked?o.unLikePost(e.item.id):o.likePost(e.item.id),["stop"]))},[n(r,{name:e.item.is_liked?"heart_fill":"heart"},null,8,["name"])],2),a("button",{onClick:t[2]||(t[2]=m(d=>o.openLikersModal("posts",e.item.id),["stop"])),class:"text-base-xs font-semibold text-white"},b(e.item.like_count),1)]),a("div",{class:"flex flex-col items-center gap-1",onClick:t[3]||(t[3]=m(d=>o.handleCommentVibb(),["stop"]))},[a("button",{class:c(o.buttonActionStyle)},[n(r,{name:"message"})],2),a("span",re,b(e.item.comment_count),1)]),a("button",{class:"flex flex-col items-center gap-1",onClick:t[4]||(t[4]=m((...d)=>o.handleOpenPostAnalytics&&o.handleOpenPostAnalytics(...d),["stop"]))},[a("div",{class:c(o.buttonActionStyle)},[n(r,{name:"eye"})],2),a("span",de,b(e.item.view_count),1)]),a("button",{ref:"bookmarkButton",class:c(["feed-main-action-bookmark",e.item.is_bookmarked?"text-primary-color dark:text-dark-primary-color is-bookmarked":"",o.buttonActionStyle]),onClick:t[5]||(t[5]=m(d=>e.item.is_bookmarked?o.unBookmarkPost(e.item.id):o.bookmarkPost(e.item.id),["stop"]))},[n(r,{name:e.item.is_bookmarked?"bookmark_fill":"bookmarks"},null,8,["name"])],2),a("button",{onClick:t[6]||(t[6]=m(d=>o.openShareModal("posts",e.item),["stop"])),class:c(o.buttonActionStyle)},[n(r,{name:"share"})],2),s.authenticated?(i(),u("button",{key:0,onClick:t[7]||(t[7]=m(d=>o.openDropdownMenu(),["stop"])),class:c(o.buttonActionStyle)},[n(r,{name:"more_horiz_outlined"})],2)):L("",!0)])],8,se)])]),_:1},8,["content-warning-list","post"])):(i(),h(j,{key:1,class:"mb-0"},{default:_(()=>[S(b(s.$t("Vibb is not found")),1)]),_:1}))}const ue=M(oe,[["render",me]]),ce={components:{PostContent:te,VibbContent:ue},props:{post:Object,shadow:{type:Boolean,default:!1}},computed:{...p(O,["setOpenedModalCount"]),...p(V,["user"])},methods:{showPostDetail(){let s=this.$router.resolve({name:"post",params:{id:this.post.id}});I(s.fullPath),this.setOpenedModalCount(),this.$dialog.open(ee,{data:{post:this.post},props:{class:"post-detail-modal p-dialog-lg p-dialog-full-page",modal:!0,dismissableMask:!0,showHeader:!1,draggable:!1},onClose:()=>{I(this.$router.currentRoute.value.fullPath),g(),this.setOpenedModalCount(!1)}})}}},be={key:0};function he(s,t,e,x,y,o){const k=l("VibbContent"),f=l("PostContent");return i(),u("div",{class:c(["feed-item bg-white border border-white rounded-none md:rounded-base-lg mb-base-2 dark:bg-slate-800 dark:border-slate-800",{"shadow-post-item dark:shadow-post-item-dark":e.shadow}])},[e.post.type==="vibb"?(i(),u("div",be,[n(k,{item:e.post,"auto-play":s.user.video_auto_play},null,8,["item","auto-play"])])):(i(),h(f,{key:1,post:e.post,"auto-play":s.user.video_auto_play,onComment_click:o.showPostDetail,onComment_count_click:o.showPostDetail},null,8,["post","auto-play","onComment_click","onComment_count_click"]))],2)}const ke=M(ce,[["render",he]]),fe={components:{SkeletonPostsList:U,PostListsItem:ke,InfiniteLoading:Y,Loading:K},props:{loading:{type:Boolean,default:!0},postsList:{type:Array,default:()=>[]},loadMore:{type:Boolean,default:!0},shadow:{type:Boolean,default:!1}},methods:{handleLoadInfinite(s){this.loadMore&&this.$emit("load-more",s)}},emits:["load-more"]},ge={class:"pb-5"},pe={class:"main-content-section bg-white border border-white text-main-color p-10 text-center rounded-none mb-base-2 md:rounded-base-lg dark:bg-slate-800 dark:border-slate-800 dark:text-white"},_e={class:"text-base-lg font-bold mb-base-2"},ye={class:"text-base-sm"};function we(s,t,e,x,y,o){const k=l("SkeletonPostsList"),f=l("PostListsItem"),w=l("Loading"),C=l("InfiniteLoading");return i(),u("div",ge,[e.loading?(i(),h(k,{key:0})):(i(),u(P,{key:1},[e.postsList.length>0?(i(),u(P,{key:0},[n(Z,{name:"fade"},{default:_(()=>[(i(!0),u(P,null,X(e.postsList,r=>(i(),h(f,{key:r.id,post:r,shadow:e.shadow},null,8,["post","shadow"]))),128))]),_:1}),e.loadMore?(i(),h(C,{key:0,onInfinite:o.handleLoadInfinite},{spinner:_(()=>[n(w)]),complete:_(()=>t[0]||(t[0]=[a("span",null,null,-1)])),_:1},8,["onInfinite"])):L("",!0)],64)):$(s.$slots,"empty",{key:1},()=>[a("div",pe,[a("div",_e,b(s.$t("Nothing to see here yet")),1),a("div",ye,b(s.$t("Start following people and tags to see updated posts")),1)])])],64))])}const Me=M(fe,[["render",we]]);export{Me as P};
