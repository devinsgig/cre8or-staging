import{b0 as $,cV as y,c_ as x,B as b,m as u,y as w,p as _,ak as h,_ as R,r,o as p,c as f,b as s,d as a,w as l,e as v,t as n,h as L,F as B}from"../../assets/app-8df99815.js";import{P as I}from"./PostsList-f3c51b69.js";import"./SkeletonPostsList-68921a0e.js";import"./PostDetailModal-69941281.js";import"./PostContent-93850f8e.js";const j={components:{Avatar:$,Mentionable:y,EmojiPicker:x,BaseButton:b},inject:["dialogRef"],data(){return{content:"",isRecommend:this.dialogRef.data.isRecommend,page:this.dialogRef.data.page}},computed:{...u(w,["user"])},methods:{..._(h,["postNewReviewFeed"]),addEmoji(e){this.$refs.recommendContent.addContent(e)},async handleClickRecommend(){try{const e=await this.postNewReviewFeed({content:this.content,is_recommend:this.isRecommend,page_id:this.page.id});this.dialogRef.close({review:e}),this.showSuccess(this.$t("Your review have been sent."))}catch(e){this.showError(e.error)}}}},E={class:"flex gap-base-2 border-b border-divider pb-base-2 mb-base-2 dark:border-white/10"},N={class:"flex-1"},M={class:"text-end"};function V(e,t,P,k,o,i){const d=r("Avatar"),c=r("Mentionable"),m=r("EmojiPicker"),C=r("BaseButton");return p(),f("div",null,[s("div",E,[a(d,{user:e.user,router:!1,activePopover:!1},null,8,["user"]),s("div",N,[a(c,{modelValue:o.content,"onUpdate:modelValue":t[0]||(t[0]=g=>o.content=g),placeholder:o.isRecommend?e.$t("What do you recommend about")+" "+o.page.name+"?":e.$t("Leave your feedback for")+" "+o.page.name,rows:1,ref:"recommendContent",autofocus:!0,className:"max-h-[75vh] lg:max-h-[60vh]"},null,8,["modelValue","placeholder"])]),a(m,{onEmoji_click:i.addEmoji},null,8,["onEmoji_click"])]),s("div",M,[a(C,{onClick:t[1]||(t[1]=g=>i.handleClickRecommend())},{default:l(()=>[v(n(e.$t("Send")),1)]),_:1})])])}const S=R(j,[["render",V]]),A={components:{BaseButton:b,PostsList:I},props:["userInfo"],data(){return{userReviewInfo:this.userInfo,currentPage:1}},computed:{...u(w,["user"]),...u(h,["postsList","loadingPostsList"])},mounted(){this.getReviewsPageList(this.userReviewInfo.id,this.currentPage),this.setCurrentPostPage("review")},unmounted(){this.unsetPostsList(),this.setCurrentPostPage()},methods:{..._(h,["getReviewsPageList","unsetPostsList","setCurrentPostPage"]),handleClickRecommend(e){this.$dialog.open(S,{data:{page:this.userReviewInfo,isRecommend:e},props:{header:e?this.$t("Recommend")+" "+this.userReviewInfo.name:this.$t("How can")+" "+this.userReviewInfo.name+" "+this.$t("improve?"),class:"p-dialog-lg",modal:!0,draggable:!1},onClose:async t=>{t.data&&(this.userReviewInfo.can_review=!1)}})},loadMoreReviews(e){this.getReviewsPageList(this.userReviewInfo.id,++this.currentPage).then(t=>{t.length===0?e.complete():e.loaded()})}},emits:["change_tab","update_user_info"]},F={key:0,class:"main-content-section bg-white p-5 mb-base-2 rounded-none md:rounded-base-lg dark:bg-slate-800"},D={class:"text-main-color text-base-lg font-extrabold dark:text-white mb-base-2"},U={class:"flex gap-base-2"},Y={class:"flex-1"},H={class:"flex-1"},T={class:"flex gap-base-2 justify-between items-center mb-base-2 px-base-2 md:px-0"},W={class:"text-main-color text-base-lg font-extrabold dark:text-white"},q={class:"main-content-section bg-white border border-white text-main-color p-10 text-center rounded-none mb-base-2 md:rounded-base-lg dark:bg-slate-800 dark:border-slate-800 dark:text-white"},z={class:"text-base-sm"};function G(e,t,P,k,o,i){const d=r("BaseButton"),c=r("PostsList");return p(),f(B,null,[o.userReviewInfo.can_review?(p(),f("div",F,[s("h3",D,n(e.$t("Do you recommend")+" "+o.userReviewInfo.name+"?"),1),s("div",U,[s("div",Y,[a(d,{type:"secondary",class:"w-full",onClick:t[0]||(t[0]=m=>i.handleClickRecommend(!0))},{default:l(()=>[v(n(e.$t("Yes")),1)]),_:1})]),s("div",H,[a(d,{type:"secondary",class:"w-full",onClick:t[1]||(t[1]=m=>i.handleClickRecommend(!1))},{default:l(()=>[v(n(e.$t("No")),1)]),_:1})])])])):L("",!0),s("div",T,[s("h3",W,n(e.$t("Rating"))+" Â· "+n(o.userReviewInfo.review_score)+" "+n(e.$filters.numberShortener(o.userReviewInfo.review_count,e.$t("([number] review)"),e.$t("([number] reviews)"))),1)]),a(c,{loading:e.loadingPostsList,"posts-list":e.postsList,onLoadMore:i.loadMoreReviews},{empty:l(()=>[s("div",q,[s("div",z,n(e.$t("Nothing to see here yet")),1)])]),_:1},8,["loading","posts-list","onLoadMore"])],64)}const Z=R(A,[["render",G]]);export{Z as default};
