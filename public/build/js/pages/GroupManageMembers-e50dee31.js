import{B as q,m as B,aF as C,aG as x,y as v,_,r as c,o as g,c as M,b as h,t as n,g as k,w as d,e as m,h as L,d as a,F as w,aH as G,aI as T,aJ as J,aK as A,aL as P,aM as j,s as $,aN as S,aO as V,aP as E,aQ as N,aR as U,T as I,l as O,N as D}from"../../assets/app-8df99815.js";import{G as R}from"./GroupMembersList-c38b600c.js";import{T as z,A as F}from"./AddModeratorsModal-1a65fd1b.js";const H={props:["adminConfig"],components:{GroupMembersList:R,BaseButton:q},data(){return{groupOwner:null,currentModeratorPage:1,loadingModeratorList:!0,moderatorsList:[],loadmoreModeratorsList:!1}},computed:{...B(v,["user"])},mounted(){this.handleGetAdminsList(this.adminConfig.group.id,this.currentModeratorPage)},methods:{async handleGetAdminsList(e,t){try{const r=await C(e,t);t==1&&(this.moderatorsList=[],this.groupOwner=r.owner),this.moderatorsList=window._.concat(this.moderatorsList,r.items),r.has_next_page?(this.loadmoreModeratorsList=!0,this.currentModeratorPage++):this.loadmoreModeratorsList=!1}catch(r){this.showError(r.error)}finally{this.loadingModeratorList=!1}},handleTransferAdmin(){this.$dialog.open(z,{data:{subject_type:"group",subject:this.adminConfig.group},props:{header:this.$t("Transfer Admin Account"),modal:!0,dismissableMask:!0,draggable:!1}})},handleAddModerator(){this.$dialog.open(F,{data:{subject_type:"group",subject_id:this.adminConfig.group.id},props:{header:this.$t("Add Moderator"),modal:!0,dismissableMask:!0,draggable:!1},onClose:e=>{e.data&&(this.moderatorsList.push(e.data.adminInfo),this.$emit("updated"))}})},async handleRemoveModerator(e){this.$confirm.require({message:this.adminConfig.is_owner?this.$t("Are you sure you want to remove this moderator?"):this.$t("Are you sure you want to remove yourself from the moderators list?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await x(e.id),this.showSuccess(this.$t("Remove Successfully")),this.moderatorsList=this.moderatorsList.filter(t=>t.id!==e.id),this.user.id===e.user.id?this.$router.push({name:"group_profile",params:{id:this.adminConfig.group.id,slug:this.adminConfig.group.slug}}):this.$emit("updated")}catch(t){this.showError(t.error)}}})}},emits:["updated"]},K={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},Q={class:"text-base-lg font-extrabold"},W={class:"flex flex-wrap items-center justify-between gap-2 my-base-2 pt-base-2 border-t border-divider dark:border-white/10"},X={class:"text-base-lg font-extrabold"};function Y(e,t,r,i,s,o){const l=c("BaseButton"),f=c("GroupMembersList");return g(),M(w,null,[h("div",K,[h("h3",Q,n(e.$t("Admin")),1),r.adminConfig.is_owner?(g(),k(l,{key:0,onClick:t[0]||(t[0]=b=>o.handleTransferAdmin())},{default:d(()=>[m(n(e.$t("Transfer")),1)]),_:1})):L("",!0)]),a(f,{loading:!r.adminConfig.owner,"members-list":[r.adminConfig.owner]},null,8,["loading","members-list"]),h("div",W,[h("h3",X,n(e.$t("Moderators")),1),r.adminConfig.is_owner?(g(),k(l,{key:0,onClick:t[1]||(t[1]=b=>o.handleAddModerator())},{default:d(()=>[m(n(e.$t("Add moderator")),1)]),_:1})):L("",!0)]),a(f,{loading:s.loadingModeratorList,"members-list":s.moderatorsList,"has-load-more":s.loadmoreModeratorsList,onLoadMore:t[2]||(t[2]=b=>o.handleGetAdminsList(r.adminConfig.group.id,s.currentModeratorPage))},{actions:d(({member:b})=>[r.adminConfig.is_owner||e.user.id===b.user.id?(g(),k(l,{key:0,size:"xs",onClick:u=>o.handleRemoveModerator(b),type:"danger"},{default:d(()=>[m(n(e.$t("Remove")),1)]),_:2},1032,["onClick"])):L("",!0)]),empty:d(()=>[m(n(e.$t("No moderators")),1)]),_:1},8,["loading","members-list","has-load-more"])],64)}const Z=_(H,[["render",Y]]),ee={props:["adminConfig"],components:{BaseCheckbox:G,GroupMembersList:R,BaseButton:q},data(){return{selectedJoinRequestsList:[],searchJoinRequestText:"",currentJoinRequestPage:1,loadingJoinRequestsList:!0,joinRequestsList:[],loadmoreJoinRequestsList:!1}},mounted(){this.handleGetGroupJoinRequests(this.adminConfig.group.id,this.searchJoinRequestText,this.currentJoinRequestPage)},methods:{async handleGetGroupJoinRequests(e,t,r){try{const i=await T(e,t,r);r==1&&(this.joinRequestsList=[]),this.joinRequestsList=window._.concat(this.joinRequestsList,i.items),i.has_next_page?(this.loadmoreJoinRequestsList=!0,this.currentJoinRequestPage++):this.loadmoreJoinRequestsList=!1}catch(i){this.showError(i.error)}finally{this.loadingJoinRequestsList=!1}},debouncedGetJoinRequestsList:window._.debounce(function(){this.handleGetGroupJoinRequests(this.adminConfig.group.id,this.searchJoinRequestText,this.currentJoinRequestPage)},500),handleSearchJoinRequests(){this.currentJoinRequestPage=1,this.debouncedGetJoinRequestsList()},async handleApproveJoinRequest(e){try{await J(e),this.joinRequestsList=this.joinRequestsList.filter(t=>t.id!==e),this.$emit("updated")}catch(t){this.showError(t.error)}},handleAcceptMultiRequests(){this.$confirm.require({message:this.$t("Are you sure you want to approve selected requests?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await A(this.adminConfig.group.id,this.selectedJoinRequestsList),this.joinRequestsList=this.joinRequestsList.filter(e=>!this.selectedJoinRequestsList.includes(e.id)),this.$emit("updated")}catch(e){this.showError(e.error)}}})},async handleDeleteJoinRequest(e){this.$confirm.require({message:this.$t("Are you sure you want to reject this request?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await P(e),this.joinRequestsList=this.joinRequestsList.filter(t=>t.id!==e),this.$emit("updated")}catch(t){this.showError(t.error)}}})},handleDeleteMultiJoinRequests(){this.$confirm.require({message:this.$t("Are you sure you want to reject selected requests?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await j(this.adminConfig.group.id,this.selectedJoinRequestsList),this.joinRequestsList=this.joinRequestsList.filter(e=>!this.selectedJoinRequestsList.includes(e.id)),this.$emit("updated")}catch(e){this.showError(e.error)}}})}},emits:["updated"]},te={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},se={class:"text-base-lg font-extrabold"},re={key:0,class:"flex flex-wrap gap-base-2"},oe={class:"flex items-center gap-base-2"};function ie(e,t,r,i,s,o){const l=c("BaseButton"),f=c("BaseInputText"),b=c("BaseCheckbox"),u=c("GroupMembersList");return g(),M(w,null,[h("div",te,[h("h3",se,n(e.$t("Pending requests")),1),s.selectedJoinRequestsList.length?(g(),M("div",re,[a(l,{onClick:t[0]||(t[0]=p=>o.handleAcceptMultiRequests())},{default:d(()=>[m(n(e.$t("Approve Selected")),1)]),_:1}),a(l,{onClick:t[1]||(t[1]=p=>o.handleDeleteMultiJoinRequests()),type:"danger"},{default:d(()=>[m(n(e.$t("Reject Selected")),1)]),_:1})])):L("",!0)]),a(f,{modelValue:s.searchJoinRequestText,"onUpdate:modelValue":t[2]||(t[2]=p=>s.searchJoinRequestText=p),onInput:o.handleSearchJoinRequests,placeholder:e.$t("Search join requests"),class:"max-w-xs mb-base-2"},null,8,["modelValue","onInput","placeholder"]),a(u,{loading:s.loadingJoinRequestsList,"members-list":s.joinRequestsList,"has-load-more":s.loadmoreJoinRequestsList,onLoadMore:t[4]||(t[4]=p=>o.handleGetGroupJoinRequests(r.adminConfig.group.id,s.searchJoinRequestText,s.currentJoinRequestPage))},{actions:d(({member:p})=>[h("div",oe,[a(l,{size:"xs",onClick:y=>o.handleApproveJoinRequest(p.id)},{default:d(()=>[m(n(e.$t("Approve")),1)]),_:2},1032,["onClick"]),a(l,{size:"xs",onClick:y=>o.handleDeleteJoinRequest(p.id),type:"danger"},{default:d(()=>[m(n(e.$t("Reject")),1)]),_:2},1032,["onClick"]),a(b,{modelValue:s.selectedJoinRequestsList,"onUpdate:modelValue":t[3]||(t[3]=y=>s.selectedJoinRequestsList=y),value:p.id},null,8,["modelValue","value"])])]),empty:d(()=>[m(n(e.$t("No pending requests")),1)]),_:1},8,["loading","members-list","has-load-more"])],64)}const ne=_(ee,[["render",ie]]),ae={props:["adminConfig"],components:{BaseInputText:$,GroupMembersList:R,BaseButton:q},data(){return{searchMemberText:"",currentMemberPage:1,loadingMembersList:!0,membersList:[],loadmoreMembersList:!1}},mounted(){this.handleGetGroupMember(this.adminConfig.group.id,this.searchMemberText,this.currentMemberPage)},methods:{async handleGetGroupMember(e,t,r){try{const i=await S(e,t,r);r==1&&(this.membersList=[]),this.membersList=window._.concat(this.membersList,i.items),i.has_next_page?(this.loadmoreMembersList=!0,this.currentMemberPage++):this.loadmoreMembersList=!1}catch(i){this.showError(i.error)}finally{this.loadingMembersList=!1}},debouncedGetGroupMembersList:window._.debounce(function(){this.handleGetGroupMember(this.adminConfig.group.id,this.searchMemberText,this.currentMemberPage)},500),handleSearchMembers(){this.currentMemberPage=1,this.debouncedGetGroupMembersList()},handleRemoveMember(e){this.$confirm.require({message:this.$t("Are you sure you want to remove this user from group?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await V(e),this.membersList=this.membersList.filter(t=>t.id!==e),this.$emit("updated")}catch(t){this.showError(t.error)}}})},handleBanMember(e){this.$confirm.require({message:this.$t("Are you sure you want to ban and remove this user from group?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await E(this.adminConfig.group.id,e),this.membersList=this.membersList.filter(t=>t.user.id!==e),this.$emit("updated")}catch(t){this.showError(t.error)}}})}},emits:["updated"]},de={class:"text-base-lg font-extrabold mb-base-2"},le={class:"flex items-center gap-base-2"};function ue(e,t,r,i,s,o){const l=c("BaseInputText"),f=c("BaseButton"),b=c("GroupMembersList");return g(),M(w,null,[h("h3",de,n(e.$t("Members and pages")),1),a(l,{modelValue:s.searchMemberText,"onUpdate:modelValue":t[0]||(t[0]=u=>s.searchMemberText=u),onInput:o.handleSearchMembers,placeholder:e.$t("Search members"),class:"max-w-xs mb-base-2"},null,8,["modelValue","onInput","placeholder"]),a(b,{loading:s.loadingMembersList,"members-list":s.membersList,"has-load-more":s.loadmoreMembersList,onLoadMore:t[1]||(t[1]=u=>o.handleGetGroupMember(r.adminConfig.group.id,s.searchMemberText,s.currentMemberPage))},{actions:d(({member:u})=>[h("div",le,[a(f,{size:"xs",onClick:p=>o.handleRemoveMember(u.id),type:"danger"},{default:d(()=>[m(n(e.$t("Remove")),1)]),_:2},1032,["onClick"]),a(f,{size:"xs",onClick:p=>o.handleBanMember(u.user.id),type:"warning"},{default:d(()=>[m(n(e.$t("Ban")),1)]),_:2},1032,["onClick"])])]),_:1},8,["loading","members-list","has-load-more"])],64)}const me=_(ae,[["render",ue]]),ce={props:["adminConfig"],components:{BaseInputText:$,GroupMembersList:R,BaseButton:q},data(){return{searchBlockedMemberText:"",currentBlockedMemberPage:1,loadingBlockedMembersList:!0,blockedMembersList:[],loadmoreBlockedMembersList:!1}},mounted(){this.handleGetBlockedMembers(this.adminConfig.group.id,this.searchBlockedMemberText,this.currentBlockedMemberPage)},methods:{async handleGetBlockedMembers(e,t,r){try{const i=await N(e,t,r);r==1&&(this.blockedMembersList=[]),this.blockedMembersList=window._.concat(this.blockedMembersList,i.items),i.has_next_page?(this.loadingBlockedMembersList=!0,this.currentBlockedMemberPage++):this.loadingBlockedMembersList=!1}catch(i){this.showError(i.error)}finally{this.loadingBlockedMembersList=!1}},debouncedGetBlockedMembersList:window._.debounce(function(){this.handleGetBlockedMembers(this.adminConfig.group.id,this.searchBlockedMemberText,this.currentBlockedMemberPage)},500),handleSearchBlockedMembers(){this.currentBlockedMemberPage=1,this.debouncedGetBlockedMembersList()},handleRemoveBlockedMember(e){this.$confirm.require({message:this.$t("Do you want to unban this member?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await U(e),this.blockedMembersList=this.blockedMembersList.filter(t=>t.id!==e),this.$emit("updated")}catch(t){this.showError(t.error)}}})}},emits:["updated"]},he={class:"text-base-lg font-extrabold mb-1"},be={class:"text-base-xs text-sub-color dark:text-slate-400 mb-base-2"},pe={class:"flex items-center gap-base-2"};function ge(e,t,r,i,s,o){const l=c("BaseInputText"),f=c("BaseButton"),b=c("GroupMembersList");return g(),M(w,null,[h("h3",he,n(e.$t("Banned")),1),h("p",be,n(e.$t("People who are banned can't find the group in search, see any of the content within the group or receive new invitations to the group.")),1),a(l,{modelValue:s.searchBlockedMemberText,"onUpdate:modelValue":t[0]||(t[0]=u=>s.searchBlockedMemberText=u),onInput:o.handleSearchBlockedMembers,placeholder:e.$t("Search banned members"),class:"max-w-xs mb-base-2"},null,8,["modelValue","onInput","placeholder"]),a(b,{loading:s.loadingBlockedMembersList,"members-list":s.blockedMembersList,"has-load-more":s.loadmoreBlockedMembersList,onLoadMore:t[1]||(t[1]=u=>e.handleGetGroupMember(r.adminConfig.group.id,s.searchBlockedMemberText,s.currentBlockedMemberPage))},{actions:d(({member:u})=>[h("div",pe,[a(f,{size:"xs",onClick:p=>o.handleRemoveBlockedMember(u.id)},{default:d(()=>[m(n(e.$t("Unban")),1)]),_:2},1032,["onClick"])])]),empty:d(()=>[m(n(e.$t("No blocked members")),1)]),_:1},8,["loading","members-list","has-load-more"])],64)}const fe=_(ce,[["render",ge]]),Me={props:["adminConfig","subTab"],components:{TabsMenu:I},data(){return{currentTab:this.subTab?this.subTab:""}},computed:{subMenus(){return[{name:this.$t("Admin & Moderators"),tab:"",isActive:this.currentTab===""},{name:this.$t("Members"),tab:"members",isActive:this.currentTab==="members",badge:this.shortenNumber(this.adminConfig.member_without_admin)},{name:this.$t("Pending Requests"),tab:"pending_requests",isActive:this.currentTab==="pending_requests",badge:this.shortenNumber(this.adminConfig.member_request_count)},{name:this.$t("Bans"),tab:"bans",isActive:this.currentTab==="bans",badge:this.shortenNumber(this.adminConfig.block_count)}]},manageMemberComponent(){switch(this.currentTab){case"members":return me;case"pending_requests":return ne;case"bans":return fe;default:return Z}}},methods:{changeTab(e){this.currentTab=e;let t=this.$router.resolve({name:"groups_manage",params:{tab:"groups_manage_members"}});O(t.fullPath+(e!=""?"/"+e:""))},handleUpdateData(){this.$emit("updated")}},emits:["updated"]},Le={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 dark:bg-slate-800 dark:border-slate-800 dark:text-white"};function _e(e,t,r,i,s,o){const l=c("TabsMenu");return g(),M("div",Le,[a(l,{menus:o.subMenus,type:"secondary",onSelect:o.changeTab,class:"mb-4"},null,8,["menus","onSelect"]),r.adminConfig?(g(),k(D(o.manageMemberComponent),{key:0,"admin-config":r.adminConfig,onUpdated:o.handleUpdateData},null,40,["admin-config","onUpdated"])):L("",!0)])}const Re=_(Me,[["render",_e]]);export{Re as default};
