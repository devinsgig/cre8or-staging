import{j as B,s as _,v as C,B as $,u as h,m as b,y as S,_ as T,r as o,o as f,c as V,b as s,t as a,d as l,w as m,e as p,$ as I,g as F,h as E}from"../../assets/app-8df99815.js";import{i as R,a as L}from"./invite-271dc862.js";import{C as x,u as U}from"./CloudFlareTurnstile-dd2b6044.js";import{B as A}from"./BaseInputFile-e520513a.js";const D={components:{BaseIcon:B,BaseInputText:_,BaseTextarea:C,BaseButton:$,BaseInputFile:A,CloudFlareTurnstile:x},data(){const e=h();return{emails:null,message:null,csv_file:null,token:null,inviteEmailLoading:!1,inviteCSVLoading:!1,...U(e.config.inviteEmailEnableRecapcha,this.enableRecapcha,this.enableTurnstile)}},computed:{...b(S,["user"]),...b(h,["config"])},mounted(){setTimeout(()=>{this.loadRecaptcha(this.$recaptchaInstance)},2e3)},unmounted(){this.unloadRecaptcha(this.$recaptchaInstance)},methods:{copyURL(){const e=this.$refs.urlRef,t=e.textContent;navigator.clipboard.writeText(t),this.showSuccess(this.$t("This link copied!"));const d=document.createRange();d.selectNodeContents(e);const c=window.getSelection();c.removeAllRanges(),c.addRange(d)},async inviteEmails(){this.inviteEmailLoading=!0;try{this.token=await this.getCaptchaToken(this.$recaptcha,this.turnstileToken,"invite"),await R({token:this.token,emails:this.emails,message:this.message}),this.emails=null,this.message=null,this.showSuccess(this.$t("Your invitation has been sent."))}catch(e){this.showError(e.error)}finally{this.inviteEmailLoading=!1}},selectFile(e){this.csv_file=e.target.files[0]},async inviteCsvFile(){this.inviteCSVLoading=!0;try{this.config.inviteEmailEnableRecapcha&&(this.enableRecapcha()?await this.$recaptcha("invite").then(t=>{this.token=t}):this.enableTurnstile()&&(this.token=this.turnstileToken));let e=new FormData;if(this.csv_file){if(!this.checkUploadedData(this.csv_file,"csv"))return;e.append("csv_file",this.csv_file)}e.append("token",this.token),await L(e),this.csv_file=null,this.$refs.BaseInputFile.clearSelectedFile(),this.showSuccess(this.$t("Your invitation has been sent."))}catch(e){this.showError(e.error)}finally{this.inviteCSVLoading=!1}}}},N={class:"px-base-2 py-5"},M={class:"font-bold text-center mb-base-2"},j={class:"text-center mb-base-2"},Y={class:"invites-button flex justify-between items-center gap-2 bg-web-wash px-5 py-base-2 rounded-base-10xl border border-dashed border-secondary-box-color dark:bg-dark-web-wash dark:border-white/10"},W={class:"font-bold text-center mt-base-7 mb-base-2"},q={class:"mb-base-2"},z={class:"mb-base-2"},G={class:"text-center"},H={class:"font-bold text-center mt-base-7 mb-base-2"},J={class:"mb-1"},K={class:"text-start mb-base-2"},O=["href"],P={class:"text-center"};function Q(e,t,d,c,n,r){const v=o("BaseIcon"),g=o("BaseInputText"),k=o("BaseTextarea"),u=o("BaseButton"),w=o("BaseInputFile"),y=o("CloudFlareTurnstile");return f(),V("div",N,[s("p",M,a(e.$t("Invite by link")),1),s("p",j,a(e.$t("Copy the link below to invite people")),1),s("div",Y,[s("div",{ref:"urlRef",class:"flex-1 truncate"},a(e.user.ref_url),513),s("button",{class:"flex align-items-center gap-2 whitespace-nowrap",onClick:t[0]||(t[0]=i=>r.copyURL())},[l(v,{name:"link_simple",class:"invites-button-icon text-primary-color dark:text-dark-primary-color"}),s("span",null,a(e.$t("Copy link")),1)])]),s("p",W,a(e.$t("Invite by email")),1),s("form",{onSubmit:t[3]||(t[3]=I((...i)=>r.inviteEmails&&r.inviteEmails(...i),["prevent"]))},[s("div",q,[l(g,{modelValue:n.emails,"onUpdate:modelValue":t[1]||(t[1]=i=>n.emails=i),placeholder:e.$filters.numberShortener(e.config.inviteMax,e.$t("Add up to [number] email address, separated by commas"),e.$t("Add up to [number] email addresses, separated by commas")),tooltip_mobile:e.$filters.numberShortener(e.config.inviteMax,e.$t("Add up to [number] email address, separated by commas"),e.$t("Add up to [number] email addresses, separated by commas"))},null,8,["modelValue","placeholder","tooltip_mobile"])]),s("div",z,[l(k,{modelValue:n.message,"onUpdate:modelValue":t[2]||(t[2]=i=>n.message=i),placeholder:e.$t("Message"),rows:5},null,8,["modelValue","placeholder"])]),s("div",G,[l(u,{loading:n.inviteEmailLoading,disabled:!e.isVerified()},{default:m(()=>[p(a(e.$t("Send")),1)]),_:1},8,["loading","disabled"])])],32),s("p",H,a(e.$t("Invite by CSV")),1),s("div",J,[l(w,{ref:"BaseInputFile",onUploadFile:r.selectFile,accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"},{default:m(()=>[p(a(e.$t("Import Contact")),1)]),_:1},8,["onUploadFile"])]),s("div",K,[s("a",{href:e.asset("files/invite_example.csv"),download:""},a(e.$t("Download csv sample")),9,O)]),s("div",P,[l(u,{loading:n.inviteCSVLoading,disabled:!e.isVerified(),onClick:t[4]||(t[4]=i=>r.inviteCsvFile()),class:"mb-base-2"},{default:m(()=>[p(a(e.$t("Send")),1)]),_:1},8,["loading","disabled"]),e.enableWidget?(f(),F(y,{key:0,modelValue:e.turnstileToken,"onUpdate:modelValue":t[5]||(t[5]=i=>e.turnstileToken=i)},null,8,["modelValue"])):E("",!0)])])}const se=T(D,[["render",Q]]);export{se as default};
