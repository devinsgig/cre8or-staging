import{_ as p,B as g,a8 as s,e5 as f,e6 as h,r as l,o as u,c as _,d as c,b as m,w as C,e as w,t as B}from"../../assets/app-8df99815.js";import{f as D}from"./style-a13dfc58.js";const b={components:{Cropper:D,BaseButton:g},inject:{dialogRef:{default:null}},data(){return{imageData:this.dialogRef.data.imageData,loading:!1}},methods:{async cropCover(){let{canvas:t}=this.$refs.cropper.getResult();if(t){const o=new FormData;var e;if(t.width>s.COVER_WIDTH){e=document.createElement("canvas");var n=e.getContext("2d");e.width=s.COVER_WIDTH,e.height=s.COVER_HEIGHT,n.drawImage(t,0,0,t.width,t.height,0,0,e.width,e.height)}else e=t;e.toBlob(async r=>{let i=new File([r],"Cover.png",{type:"image/png"});if(o.append("file",i),this.imageData.subject_type==="group"&&o.append("id",this.imageData.subject_id),!this.loading){this.loading=!0;try{let a;switch(this.imageData.subject_type){case"group":a=await h(o);break;default:a=await f(o);break}this.dialogRef.close(a)}catch(a){this.showError(a.error)}finally{this.loading=!1}}})}}}},y={class:"text-end mt-base-2"};function R(t,e,n,o,r,i){const a=l("cropper"),d=l("BaseButton");return u(),_("div",null,[c(a,{ref:"cropper","stencil-props":{aspectRatio:5.2/2},"min-height":200,src:r.imageData.file},null,8,["src"]),m("div",y,[c(d,{loading:r.loading,onClick:i.cropCover},{default:C(()=>[w(B(t.$t("Crop Cover Image")),1)]),_:1},8,["loading","onClick"])])])}const k=p(b,[["render",R]]);export{k as default};
