import{_ as y,T as B,ah as k,ai as _,B as S,j as C,aj as x,m as d,y as I,ak as m,u as T,al as L,p as A,r as n,o as a,c as h,b as o,d as l,F as j,g as u,w as F,e as P,t as z,h as f,Q as c,S as M}from"../../assets/app-8df99815.js";const D={props:["tab"],components:{TabsMenu:B,VibbItem:k,VibbsList:_,BaseButton:S,BaseIcon:C,VibbComment:x},data(){return{currentTab:this.tab?this.tab:"",vibbId:this.$route.query.id?this.$route.query.id:0,currentPage:1,isAtTop:!0,isAtBottom:!0,show_upload_video:!1,loadingVibbDetail:!0}},computed:{...d(I,["user","authenticated"]),...d(m,["loadingVibbsList","vibbsList","vibbInfo","deletedPost"]),...d(T,["screen","config"]),...d(L,["showVibbComment"]),vibbMenus(){return[{name:this.$t("For you"),isShow:!0,isActive:this.currentTab==="",tab:""},{name:this.$t("Following"),isShow:!0,isActive:this.currentTab==="following",tab:"following"}]},filteredVibbs(){return this.vibbsList.filter(e=>e.id!=this.vibbId)}},mounted(){this.handleGetVibbs(),this.vibbId&&this.loadVibbInfo(this.vibbId),this.show_upload_video=this.config.ffmegEnable},unmounted(){this.unsetVibbsList(),this.unsetVibbInfo()},watch:{vibbsList(){this.isAtBottom=!(this.filteredVibbs.length>0)},$route(){this.vibbId=this.$route.query.id?this.$route.query.id:0},deletedPost(){this.updateButtonState(),this.isAtBottom?this.handleScrollUp():this.handleScrollDown()}},methods:{...A(m,["getVibbsForYouList","getFollowingVibbsList","getVibbById","unsetVibbsList","unsetVibbInfo"]),onScroll(e){this.updateButtonState(),e.preventDefault()},updateButtonState(){const e=this.$refs.vibbContainer;this.isAtTop=e.scrollTop===0,this.isAtBottom=e.scrollHeight-e.scrollTop===e.clientHeight},async loadVibbInfo(e){try{await this.getVibbById(e)}catch(t){this.showError(t.error)}finally{this.loadingVibbDetail=!1}},handleGetVibbs(){this.currentTab==="following"?this.getFollowingVibbsList(this.currentPage):this.getVibbsForYouList(this.currentPage)},loadMoreVibbs(e){this.currentTab==="following"?this.getFollowingVibbsList(++this.currentPage).then(t=>{t.length===0?(e.complete(),this.isAtBottom=!0):e.loaded()}):this.getVibbsForYouList(++this.currentPage).then(t=>{t.length===0?(e.complete(),this.isAtBottom=!0):e.loaded()})},handleCreateVibb(){if(!this.authenticated){this.$router.push({name:"login"});return}if(this.user){let e="vibb.allow_create";this.checkPermission(e)&&this.$router.push({name:"vibb_create"})}},handleScrollUp(){this.$refs.vibbContainer.scrollBy({top:-100})},handleScrollDown(){this.$refs.vibbContainer.scrollBy({top:100})},changeTab(e){this.currentTab=e,this.currentPage=1,this.vibbId=0,this.unsetVibbInfo(),this.handleGetVibbs()},handleBackToHome(){this.$router.push({name:"home"})}}},H={class:"bg-black fixed inset-0 z-[999] px-4 pt-16 pb-6"},q={class:"absolute top-3 start-4 end-4 flex flex-wrap items-center justify-between gap-2 z-[1001]"},N={class:"flex-1"},U={class:"flex-1 text-end"},E={class:"flex items-center justify-center h-full"},G={class:"hidden md:flex flex-col gap-4 items-center justify-center absolute top-1/2 -translate-y-1/2 end-4"};function Y(e,t,Q,J,r,s){const b=n("BaseIcon"),g=n("TabsMenu"),p=n("BaseButton"),w=n("VibbItem"),v=n("VibbsList"),V=n("VibbComment");return a(),h("div",H,[o("div",q,[o("div",N,[o("button",{onClick:t[0]||(t[0]=(...i)=>s.handleBackToHome&&s.handleBackToHome(...i)),class:"vibb-action-button flex items-center justify-center bg-white shadow-md dark:bg-slate-800 dark:shadow-slate-600 w-10 h-10 rounded-full"},[l(b,{name:"caret_left",size:"24"})])]),l(g,{menus:s.vibbMenus,type:"secondary",onSelect:s.changeTab,class:"vibb-menu flex-3 flex justify-center text-white"},null,8,["menus","onSelect"]),o("div",U,[r.show_upload_video?(a(),h(j,{key:0},[e.screen.md?(a(),h("button",{key:0,onClick:t[1]||(t[1]=(...i)=>s.handleCreateVibb&&s.handleCreateVibb(...i)),class:"vibb-action-button flex items-center justify-center justify-self-end bg-white shadow-md dark:bg-slate-800 dark:shadow-slate-600 w-10 h-10 rounded-full ms-auto"},[l(b,{name:"plus_circle",size:"24"})])):(a(),u(p,{key:1,onClick:s.handleCreateVibb},{default:F(()=>[P(z(e.$t("Create new vibb")),1)]),_:1},8,["onClick"]))],64)):f("",!0)])]),o("div",E,[o("div",{ref:"vibbContainer",class:c(["flex items-center vibb-container w-full h-full scrollbar-hidden",{"fixed inset-0 z-10":e.screen.md}]),style:M({"overflow-y":e.showVibbComment&&e.screen.md?"hidden":"scroll"}),onScroll:t[2]||(t[2]=(...i)=>s.onScroll&&s.onScroll(...i))},[r.vibbId?(a(),u(w,{key:0,item:e.vibbInfo},null,8,["item"])):f("",!0),(a(),u(v,{key:r.currentTab,loading:e.loadingVibbsList,"vibbs-list":s.filteredVibbs,onLoadMore:s.loadMoreVibbs},null,8,["loading","vibbs-list","onLoadMore"]))],38),l(V),o("div",G,[o("button",{class:c(["vibb-action-button w-12 h-12 flex items-center justify-center bg-white shadow-md rounded-full relative hover:bg-hover dark:bg-slate-800 dark:text-white dark:shadow-slate-600 transition-all duration-300 ease-linear",r.isAtTop?"opacity-0 top-[64px]":"opacity-100 top-0 z-10"]),onClick:t[3]||(t[3]=(...i)=>s.handleScrollUp&&s.handleScrollUp(...i))},[l(b,{name:"arrow_up"})],2),o("button",{class:c(["vibb-action-button w-12 h-12 flex items-center justify-center bg-white shadow-md rounded-full relative hover:bg-hover dark:bg-slate-800 dark:text-white dark:shadow-slate-600 transition-all duration-300 ease-linear",r.isAtBottom?"opacity-0 -top-[64px]":"opacity-100 top-0 z-10"]),onClick:t[4]||(t[4]=(...i)=>s.handleScrollDown&&s.handleScrollDown(...i))},[l(b,{name:"arrow_down"})],2)])])])}const O=y(D,[["render",Y]]);export{O as default};
