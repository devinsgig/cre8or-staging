import{_ as b,B as g,s as f,v as T,u as r,m as B,e3 as S,r as l,o as d,c as V,b as t,t as n,d as i,g as k,h as y,w as _,e as C,F as E}from"../../assets/app-8df99815.js";import{C as $,u as v}from"./CloudFlareTurnstile-dd2b6044.js";const R={components:{BaseButton:g,BaseInputText:f,BaseTextarea:T,CloudFlareTurnstile:$},inject:{dialogRef:{default:null}},data(){const e=r(),s=v(e.config.shareEmailEnableRecapcha,this.enableRecapcha,this.enableTurnstile);return{loadingShare:!1,token:null,emails:null,message:null,type:this.dialogRef.data.type,subject:this.dialogRef.data.subject,...s}},computed:{...B(r,["config"])},mounted(){setTimeout(()=>{this.loadRecaptcha(this.$recaptchaInstance)},2e3)},unmounted(){this.unloadRecaptcha(this.$recaptchaInstance)},methods:{async shareToEmail(){this.loadingShare=!0;try{this.token=await this.getCaptchaToken(this.$recaptcha,this.turnstileToken,"share"),await S({token:this.token,subject_type:this.type,subject_id:this.subject.id,emails:this.emails,message:this.message}),this.dialogRef.close(),this.showSuccess(this.$t("Shared Successfully."))}catch(e){this.showError(e.error)}finally{this.loadingShare=!1}}}},w={class:"mb-4"},j={class:"mb-base-2"},F={class:"mb-4"},I={class:"mb-base-2"},M={class:"text-center mb-base-2"},N={class:"text-end"};function A(e,s,U,x,o,u){const m=l("BaseInputText"),c=l("BaseTextarea"),h=l("CloudFlareTurnstile"),p=l("BaseButton");return d(),V(E,null,[t("div",w,[t("div",j,n(e.$t("Email")),1),i(m,{modelValue:o.emails,"onUpdate:modelValue":s[0]||(s[0]=a=>o.emails=a),placeholder:e.$filters.numberShortener(e.config.shareEmailMax,e.$t("Add up to [number] email address, separated by commas"),e.$t("Add up to [number] email addresses, separated by commas"))},null,8,["modelValue","placeholder"])]),t("div",F,[t("div",I,n(e.$t("Message")),1),i(c,{rows:5,placeholder:e.$t("Message"),modelValue:o.message,"onUpdate:modelValue":s[1]||(s[1]=a=>o.message=a),class:"mb-base-2"},null,8,["placeholder","modelValue"])]),t("div",M,[e.enableWidget?(d(),k(h,{key:0,modelValue:e.turnstileToken,"onUpdate:modelValue":s[2]||(s[2]=a=>e.turnstileToken=a)},null,8,["modelValue"])):y("",!0)]),t("div",N,[i(p,{onClick:s[3]||(s[3]=a=>u.shareToEmail()),loading:o.loadingShare,disabled:!e.isVerified()},{default:_(()=>[C(n(e.$t("Share")),1)]),_:1},8,["loading","disabled"])])],64)}const q=b(R,[["render",A]]);export{q as default};
