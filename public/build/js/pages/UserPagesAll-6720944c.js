import{_ as p,B as m,s as u,cH as f,dZ as y,l as L,r as i,o as w,c as P,b as x,d as n,w as C,e as S,t as _,$ as B}from"../../assets/app-8df99815.js";import{U as b}from"./UserPagesList-cdf08693.js";import{s as U}from"./treeselect.esm-3db5b66c.js";import"./index.esm-3350796f.js";const V={props:["categoryId"],components:{UserPagesList:b,BaseButton:m,BaseInputText:u,TreeSelect:U},data(){return{searchPage:1,searchKeyword:"",selectedCategory:window._.invert({true:this.categoryId?this.categoryId:""}),categoriesList:[],loadingPagesList:!0,loadMoreStatus:!1,pagesList:[]}},mounted(){this.fetchPageCategories(),this.getPagesList(this.searchPage,this.searchKeyword,this.formatedSelectedCategory)},computed:{formatedSelectedCategory(){return Object.keys(this.selectedCategory)[0]}},methods:{async fetchPageCategories(){try{const s=await f();this.categoriesList=window._.map(s,function(e){return{key:e.id,label:e.name,children:window._.map(e.childs,function(o){return{key:o.id,label:o.name}})}}),this.categoriesList=[{key:"",label:"All"},...this.categoriesList]}catch(s){console.log(s)}},async getPagesList(s,e,o){try{const r=await y(s,e,o);s===1&&(this.pagesList=[]),this.pagesList=window._.concat(this.pagesList,r.items),r.has_next_page?(this.loadMoreStatus=!0,this.searchPage++):this.loadMoreStatus=!1}catch(r){console.log(r)}finally{this.loadingPagesList=!1}},searchPagesList(){this.searchPage=1,this.getPagesList(this.searchPage,this.searchKeyword,this.formatedSelectedCategory);let s=this.$router.resolve({name:"user_pages",query:{category_id:this.formatedSelectedCategory}});L(s.fullPath)}}};function T(s,e,o,r,t,l){const c=i("BaseInputText"),g=i("TreeSelect"),d=i("BaseButton"),h=i("UserPagesList");return w(),P("div",null,[x("form",{class:"flex flex-wrap gap-base-2 mb-base-2",onSubmit:e[2]||(e[2]=B((...a)=>l.searchPagesList&&l.searchPagesList(...a),["prevent"]))},[n(c,{modelValue:t.searchKeyword,"onUpdate:modelValue":e[0]||(e[0]=a=>t.searchKeyword=a),placeholder:s.$t("Keyword"),class:"flex-1 min-w-[150px] max-w-[240px]"},null,8,["modelValue","placeholder"]),n(g,{class:"flex-1 min-w-[150px] max-w-[240px]",modelValue:t.selectedCategory,"onUpdate:modelValue":e[1]||(e[1]=a=>t.selectedCategory=a),options:t.categoriesList,optionLabel:"key",optionValue:"label",placeholder:s.$t("Category")},null,8,["modelValue","options","placeholder"]),n(d,null,{default:C(()=>[S(_(s.$t("Search")),1)]),_:1})],32),n(h,{loading:t.loadingPagesList,pagesList:t.pagesList,"has-load-more":t.loadMoreStatus,onLoadMore:e[3]||(e[3]=a=>l.getPagesList(t.searchPage,t.searchKeyword,l.formatedSelectedCategory))},null,8,["loading","pagesList","has-load-more"])])}const k=p(V,[["render",T]]);export{k as default};
