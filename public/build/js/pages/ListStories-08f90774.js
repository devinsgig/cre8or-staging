import{_ as g,aB as w,B as M,c4 as B,l as f,c5 as b,ad as C,r as l,o,c as s,g as L,F as a,f as I,d as c,aC as x,w as h,b as u,h as p,e as P,t as y,m as V,c6 as $,bV as N}from"../../assets/app-8df99815.js";import{S as D}from"./SkeletonPreviewVibbsList-425a299d.js";const F={components:{InfiniteLoading:w,SkeletonPreviewVibbsList:D,BaseButton:M,StoryContentPreview:B},props:{loading:{type:Boolean,default:!0},list:{type:Array,default:()=>[]},hasLoadMore:{type:Boolean,default:!0},autoLoadMore:{type:Boolean,default:!1}},methods:{handleLoadmore(){this.hasLoadMore&&this.$emit("load-more")},handleLoadInfinite(e){this.hasLoadMore&&this.autoLoadMore&&this.$emit("load-more",e)},showStoryDetail(e){let t=this.$router.resolve({name:"story_view_item",params:{storyItemId:e}});f(t.fullPath),this.$dialog.open(b,{data:{storyItemId:e},props:{class:"p-dialog-story p-dialog-story-detail p-dialog-no-header-title",modal:!0,showHeader:!1,draggable:!1},onClose:()=>{f(this.$router.currentRoute.value.fullPath),C()}})}},emits:["load-more"]},U={key:0,class:"grid grid-cols-[repeat(auto-fill,minmax(180px,1fr))] gap-base-2"},A=["onClick"],E={key:1,class:"text-center"},H={key:0,class:"text-center mt-base-2"};function R(e,t,i,_,r,n){const d=l("SkeletonPreviewVibbsList"),S=l("StoryContentPreview"),k=l("InfiniteLoading"),v=l("BaseButton");return o(),s(a,null,[i.loading?(o(),L(d,{key:0})):(o(),s(a,{key:1},[i.list.length?(o(),s("div",U,[(o(!0),s(a,null,I(i.list,m=>(o(),s("div",{key:m.id,class:"relative pb-[162.5%] overflow-hidden rounded-lg cursor-pointer",onClick:z=>n.showStoryDetail(m.id)},[c(S,{story:m,class:"text-lg"},null,8,["story"])],8,A))),128))])):(o(),s("div",E,[x(e.$slots,"empty",{},()=>[u("div",null,y(e.$t("No Stories")),1)])]))],64)),i.autoLoadMore?(o(),s(a,{key:2},[i.hasLoadMore?(o(),L(k,{key:0,onInfinite:n.handleLoadInfinite},{spinner:h(()=>[c(d)]),complete:h(()=>t[0]||(t[0]=[u("span",null,null,-1)])),_:1},8,["onInfinite"])):p("",!0)],64)):(o(),s(a,{key:3},[i.hasLoadMore?(o(),s("div",H,[c(v,{onClick:n.handleLoadmore},{default:h(()=>[P(y(e.$t("View more")),1)]),_:1},8,["onClick"])])):p("",!0)],64))],64)}const T=g(F,[["render",R]]),Y={components:{StoriesList:T},data(){return{hasLoadMoreStories:!1,loadingStories:!0,myStoriesList:[],page:1}},mounted(){this.getMyStoriesList(this.page)},computed:{...V(N,["deleteStoryItem"])},watch:{deleteStoryItem(){this.myStoriesList=this.myStoriesList.filter(e=>e.id!==this.deleteStoryItem.id)}},methods:{async getMyStoriesList(e){try{const t=await $(e);e===1?this.myStoriesList=t.items:this.myStoriesList=window._.concat(this.myStoriesList,t.items),t.has_next_page?(this.hasLoadMoreStories=!0,this.page++):this.hasLoadMoreStories=!1,this.loadingStories=!1}catch{this.loadingStories=!1}}}},j={class:"text-2xl font-bold mb-5"};function q(e,t,i,_,r,n){const d=l("StoriesList");return o(),s(a,null,[u("h2",j,y(e.$t("Stories")),1),c(d,{loading:r.loadingStories,list:r.myStoriesList,"has-load-more":r.hasLoadMoreStories,onLoadMore:t[0]||(t[0]=S=>n.getMyStoriesList(r.page))},null,8,["loading","list","has-load-more"])],64)}const K=g(Y,[["render",q]]);export{K as default};
