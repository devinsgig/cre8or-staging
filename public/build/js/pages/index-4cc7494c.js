import{_ as T,B as $,r as u,o as r,c as d,b as s,t as a,d as c,w as p,e as f,am as S,m as y,y as v,u as C,F as k,f as B,Q as L,g as x,h as w,an as W,ao as D,p as V,V as U,W as F,ad as A,$ as P,a as M,L as I}from"../../assets/app-8df99815.js";import{g as N,s as E,a as R,b as j,c as q,d as z}from"./wallet-d0104669.js";import{B as G}from"./BaseRadio-b63270a2.js";import{B as Q}from"./BaseCalendar-e4a0da98.js";import"./index.esm-3350796f.js";const Y={components:{BaseButton:$}},H={class:"mb-base-2"},J={class:"text-end"};function K(e,t,h,b,o,l){const m=u("BaseButton");return r(),d("div",null,[s("p",H,a(e.$t("Before you can transfer funds, itâ€™s important that we verify your uniqueness. Click on the below button to start the verification process.")),1),s("div",J,[c(m,{to:{name:"verify_profile"}},{default:p(()=>[f(a(e.$t("Verify now")),1)]),_:1})])])}const O=T(Y,[["render",K]]),X={components:{BaseInputNumber:S,BaseRadio:G,BaseButton:$},data(){return{fundAmount:null,packageId:null,gatewayId:null,walletPackagesList:[],loadingProceed:!1}},computed:{...y(v,["user"]),...y(C,["config","gateways"])},mounted(){this.getWalletPackages()},methods:{async getWalletPackages(){try{const e=await N();this.walletPackagesList=e}catch(e){console.log(e)}},handleChangeFundAmount(){this.packageId=null},handleClickPackage(e){this.packageId=e.id,this.fundAmount=e.amount},async handleClickProceed(){this.loadingProceed=!0;try{const e=await E({gateway_id:this.gatewayId,amount:this.fundAmount,package_id:this.packageId});window.location.href=e.url,this.loadingProceed=!1}catch(e){this.showError(e.error),this.loadingProceed=!1}}}},Z={class:"mb-base-2"},ee={class:"text-base-xs mb-base-2"},se={class:"flex flex-wrap gap-x-6 gap-y-base-2 mb-base-2"},te=["onClick"],oe={class:"font-bold mb-base-2"},ae={key:0},ne={class:"flex flex-col gap-3 mb-base-2"},le=["for"],re={key:1},ie={class:"mb-base-2"},de={class:"text-end"};function ce(e,t,h,b,o,l){const m=u("BaseInputNumber"),_=u("BaseRadio"),g=u("BaseButton");return r(),d("div",null,[s("p",Z,a(e.$t("Amount")+" ( "+e.exchangeTokenCurrency(1))+" = "+a(e.exchangeCurrency(1)+")"),1),c(m,{modelValue:o.fundAmount,"onUpdate:modelValue":t[0]||(t[0]=i=>o.fundAmount=i),onInput:l.handleChangeFundAmount,placeholder:e.$t("Value"),autofocus:"",class:"max-w-[240px] mb-base-2"},null,8,["modelValue","onInput","placeholder"]),s("p",ee,a("~ "+e.exchangeCurrency(o.fundAmount)),1),s("div",se,[(r(!0),d(k,null,B(o.walletPackagesList,i=>(r(),d("button",{key:i.id,onClick:n=>l.handleClickPackage(i),class:L(["text-primary-color dark:text-dark-primary-color",i.id===o.packageId&&i.amount===o.fundAmount?"font-bold":""])},a(i.amount),11,te))),128))]),s("h5",oe,a(e.$t("Payment method")),1),e.gateways.length>0?(r(),d("div",ae,[s("div",ne,[(r(!0),d(k,null,B(e.gateways,i=>(r(),d("div",{key:i.id,class:"flex items-center gap-3"},[c(_,{modelValue:o.gatewayId,"onUpdate:modelValue":t[1]||(t[1]=n=>o.gatewayId=n),inputId:i.name,name:"payment_method",value:i.id},null,8,["modelValue","inputId","value"]),s("label",{for:i.name},a(i.name),9,le)]))),128))]),o.fundAmount?(r(),x(g,{key:0,onClick:t[2]||(t[2]=i=>l.handleClickProceed()),loading:o.loadingProceed},{default:p(()=>[f(a(e.$t("Proceed to add")+" "+e.exchangeTokenCurrency(o.fundAmount)),1)]),_:1},8,["loading"])):w("",!0)])):(r(),d("div",re,[s("p",ie,a(e.$t("Payment method is not available. Please contact admin for detail")),1),s("div",de,[c(g,{to:{name:"contact"}},{default:p(()=>[f(a(e.$t("Contact admin")),1)]),_:1})])]))])}const ue=T(X,[["render",ce]]),me={components:{BaseInputNumber:S,BaseButton:$,BaseSuggest:W,AutoSuggestUserItem:D},data(){return{disableAutoComplete:!1,userMentionList:[],selectedUser:[],fundAmount:null,onlySearchUser:!1,notSearchMyself:!0}},inject:["dialogRef"],computed:{...y(v,["user"]),...y(C,["config"])},methods:{...V(v,["sendFund"]),...V(U,["pingNotification"]),async suggestUsersMention(e){try{const t=await R(e.query);this.userMentionList=t}catch{this.userMentionList=[]}},sendFundToUser(){if(this.selectedUser.length===0){this.showError(this.$t("Please select user to send fund."));return}const e=this.$dialog.open(F,{props:{header:this.$t("Enter Password"),class:"password-modal",modal:!0,dismissableMask:!0,draggable:!1},emits:{onConfirm:async t=>{if(t.password)try{await j({amount:this.fundAmount,id:this.selectedUser[0].id,password:t.password}),this.pingNotification(),this.dialogRef.close(),e.close(),A(),this.showSuccess(this.$t("Send fund successfully."))}catch(h){this.showError(h.error),e.close(),A()}}}})}}},he={class:"mb-base-2"},pe={class:"mb-1"},fe={class:"mb-base-2"},ge={class:"mb-1"},be={class:"text-base-xs mb-base-2"},_e={class:"text-end"};function ye(e,t,h,b,o,l){const m=u("AutoSuggestUserItem"),_=u("BaseSuggest"),g=u("BaseInputNumber"),i=u("BaseButton");return r(),d("form",{onSubmit:t[2]||(t[2]=P((...n)=>l.sendFundToUser&&l.sendFundToUser(...n),["prevent"]))},[s("div",he,[s("div",pe,[s("label",null,a(e.$t("Username")),1)]),c(_,{modelValue:o.selectedUser,"onUpdate:modelValue":t[0]||(t[0]=n=>o.selectedUser=n),optionLabel:"name",suggestions:o.userMentionList,onComplete:l.suggestUsersMention,emptySearchMessage:e.$t("No users found")},{option:p(({option:n})=>[c(m,{user:n},null,8,["user"])]),_:1},8,["modelValue","suggestions","onComplete","emptySearchMessage"])]),s("div",fe,[s("div",ge,[s("label",null,a(e.$t("Amount")),1)]),c(g,{modelValue:o.fundAmount,"onUpdate:modelValue":t[1]||(t[1]=n=>o.fundAmount=n),placeholder:e.$t("Value"),class:"mb-base-2"},null,8,["modelValue","placeholder"]),s("p",be,a(e.$t("Availables")+": "+e.exchangeTokenCurrency(e.user.wallet_balance)),1)]),s("div",_e,[c(i,{disabled:!o.fundAmount},{default:p(()=>[f(a(e.$t("Send")),1)]),_:1},8,["disabled"])])],32)}const we=T(me,[["render",ye]]),ke={components:{BaseButton:$,BaseSelect:M,BaseCalendar:Q,Loading:I},data(){return{selectedWalletType:this.$route.query.type||"all",walletTypesList:[],selectedWalletDate:"30_day",walletDatesList:[{key:this.$t("Past 30 days"),value:"30_day"},{key:this.$t("Past 60 days"),value:"60_day"},{key:this.$t("Past 90 days"),value:"90_day"},{key:this.$t("Custom"),value:"custom"}],customFromDate:null,customToDate:null,transactionsList:[],transactionPage:1,loadmoreTransaction:!1,loadingTransaction:!0,loadingApply:!1,loadingViewMore:!1}},computed:{...y(v,["user"]),...y(C,["config"])},mounted(){if(this.getWalletTypes(),this.getWalletTransactions(this.transactionPage,this.selectedWalletType,this.selectedWalletDate),!this.config.wallet.enable)return this.$router.push({name:"permission"})},methods:{async getWalletTypes(){try{const e=await q();this.walletTypesList=window._.map(e.types,function(t,h){return{key:t,value:h}})}catch(e){console.log(e)}},async getWalletTransactions(e,t,h){this.loadingViewMore=!0;try{var b="",o="";h==="custom"&&(this.customFromDate&&(b=this.formatDateTime(this.customFromDate)),this.customToDate&&(o=this.formatDateTime(this.customToDate)));const l=await z(e,t,h,b,o);e===1?this.transactionsList=l.items:this.transactionsList=window._.concat(this.transactionsList,l.items),l.has_next_page?(this.loadmoreTransaction=!0,this.transactionPage++):this.loadmoreTransaction=!1,this.loadingTransaction=!1,this.loadingApply=!1,this.loadingViewMore=!1}catch(l){this.showError(l.error),console.log(l),this.loadingApply=!1,this.loadingViewMore=!1}},handleSearchTransactions(){this.loadingApply=!0,this.transactionPage=1,this.getWalletTransactions(this.transactionPage,this.selectedWalletType,this.selectedWalletDate)},handleClickAddFund(){this.$dialog.open(ue,{props:{header:this.$t("Add fund to wallet"),class:"add-fund-modal",modal:!0,dismissableMask:!0,draggable:!1}})},handleClickTransfer(){if(this.user){let e="wallet.transfer_fund";this.checkPermission(e)&&(this.config.wallet.fundTransferVerifyEnable&&!this.user.is_verify?this.$dialog.open(O,{props:{header:this.$t("Profile Verification"),class:"verification-modal",modal:!0,dismissableMask:!0,draggable:!1}}):this.$router.push({name:"wallet_transfer"}))}},handleClickSendFund(){if(this.user){let e="wallet.send_fund";this.checkPermission(e)&&this.$dialog.open(we,{props:{header:this.$t("Send funds to user"),class:"send-fund-modal",modal:!0,dismissableMask:!0,draggable:!1}})}}}},ve={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},Te={class:"flex flex-wrap items-center justify-between gap-2 mb-base-2"},$e={class:"text-main-color text-base-lg font-extrabold dark:text-white"},Be={class:"flex flex-wrap items-center justify-between gap-x-4 gap-y-base-2"},xe={class:"text-base-xs mb-1"},Ce={class:"font-bold mb-1"},Ve={class:"text-base-xs"},Ae={class:"flex flex-wrap gap-base-2"},Se={class:"main-content-section bg-white border border-white text-main-color rounded-none md:rounded-base-lg p-5 mb-base-2 dark:bg-slate-800 dark:border-slate-800 dark:text-white"},Pe={class:"widget-box-header flex flex-wrap items-center justify-between gap-2 mb-base-2"},Le={class:"text-main-color text-base-lg font-extrabold dark:text-white"},We={class:"flex flex-wrap gap-base-2 mb-base-2"},De={class:"flex flex-col gap-base-2 flex-1"},Ue={class:"flex flex-col sm:flex-row flex-wrap gap-base-2"},Fe={key:0,class:"flex flex-col sm:flex-row flex-wrap gap-base-2"},Me={class:"relative overflow-x-auto scrollbar-thin border border-b-0 border-table-border-color md:rounded-md dark:border-white/10"},Ie={class:"w-full text-sm whitespace-nowrap text-center"},Ne={class:"text-xs uppercase bg-table-header-color dark:bg-dark-web-wash"},Ee={scope:"col",class:"p-3 text-start"},Re={scope:"col",class:"p-3"},je={scope:"col",class:"p-3"},qe={scope:"col",class:"p-3"},ze={scope:"col",class:"p-3"},Ge={key:0},Qe={colspan:"5"},Ye={class:"p-3 text-start"},He={class:"p-3"},Je={class:"p-3"},Ke={class:"p-3"},Oe={class:"p-3"},Xe={key:1,class:"border-b border-table-border-color dark:border-gray-700"},Ze={colspan:"5",class:"p-3"},es={key:0,class:"text-center my-base-2"};function ss(e,t,h,b,o,l){const m=u("BaseButton"),_=u("BaseSelect"),g=u("BaseCalendar"),i=u("Loading");return r(),d(k,null,[s("div",ve,[s("div",Te,[s("h3",$e,a(e.$t("Wallet")),1)]),s("div",Be,[s("div",null,[s("p",xe,a(e.$t("Your balance")),1),s("div",Ce,a(e.exchangeTokenCurrency(e.user.wallet_balance))+" ~ "+a(e.exchangeCurrency(e.user.wallet_balance)),1),s("p",Ve,a(e.exchangeTokenCurrency(1))+" = "+a(e.exchangeCurrency(1)),1)]),s("div",Ae,[e.user.can_show_withdraw_wallet?(r(),x(m,{key:0,onClick:t[0]||(t[0]=n=>l.handleClickTransfer())},{default:p(()=>[f(a(e.$t("Transfer fund")),1)]),_:1})):w("",!0),e.user.can_show_send_wallet?(r(),x(m,{key:1,onClick:t[1]||(t[1]=n=>l.handleClickSendFund())},{default:p(()=>[f(a(e.$t("Send fund")),1)]),_:1})):w("",!0),c(m,{onClick:t[2]||(t[2]=n=>l.handleClickAddFund())},{default:p(()=>[f(a(e.$t("Add fund")),1)]),_:1})])])]),s("div",Se,[s("div",Pe,[s("h3",Le,a(e.$t("Billing activities")),1)]),s("div",We,[s("form",{class:"flex-1 flex flex-col md:flex-row flex-wrap gap-base-2",onSubmit:t[7]||(t[7]=P((...n)=>l.handleSearchTransactions&&l.handleSearchTransactions(...n),["prevent"]))},[s("div",De,[s("div",Ue,[c(_,{modelValue:o.selectedWalletType,"onUpdate:modelValue":t[3]||(t[3]=n=>o.selectedWalletType=n),options:o.walletTypesList,optionLabel:"key",optionValue:"value",placeholder:e.$t("Type"),class:"flex-1"},null,8,["modelValue","options","placeholder"]),c(_,{modelValue:o.selectedWalletDate,"onUpdate:modelValue":t[4]||(t[4]=n=>o.selectedWalletDate=n),options:o.walletDatesList,optionLabel:"key",optionValue:"value",placeholder:e.$t("Date"),class:"flex-1"},null,8,["modelValue","options","placeholder"])]),o.selectedWalletDate==="custom"?(r(),d("div",Fe,[c(g,{modelValue:o.customFromDate,"onUpdate:modelValue":t[5]||(t[5]=n=>o.customFromDate=n),class:"flex-1",placeholder:e.$t("From")},null,8,["modelValue","placeholder"]),c(g,{modelValue:o.customToDate,"onUpdate:modelValue":t[6]||(t[6]=n=>o.customToDate=n),class:"flex-1",placeholder:e.$t("To")},null,8,["modelValue","placeholder"])])):w("",!0)]),c(m,{loading:o.loadingApply,class:"self-start w-full md:w-auto"},{default:p(()=>[f(a(e.$t("Apply")),1)]),_:1},8,["loading"])],32)]),s("div",Me,[s("table",Ie,[s("thead",Ne,[s("tr",null,[s("th",Ee,a(e.$t("Type")),1),s("th",Re,a(e.$t("Date")),1),s("th",je,a(e.$t("Gross")),1),s("th",qe,a(e.$t("Fee")),1),s("th",ze,a(e.$t("Net")),1)])]),s("tbody",null,[o.loadingTransaction?(r(),d("tr",Ge,[s("td",Qe,[c(i,{class:"mt-base-2"})])])):(r(),d(k,{key:1},[o.transactionsList.length?(r(!0),d(k,{key:0},B(o.transactionsList,n=>(r(),d("tr",{key:n.id,class:"odd:bg-white odd:dark:bg-gray-900 even:bg-gray-50 even:dark:bg-gray-800 border-b border-table-border-color dark:border-gray-700"},[s("td",Ye,a(n.description),1),s("td",He,a(n.created_at),1),s("td",Je,a(n.gross),1),s("td",Ke,a(n.fee),1),s("td",Oe,a(n.net),1)]))),128)):(r(),d("tr",Xe,[s("td",Ze,a(e.$t("No Transactions")),1)]))],64))])])]),o.loadmoreTransaction?(r(),d("div",es,[c(m,{onClick:t[8]||(t[8]=n=>l.getWalletTransactions(o.transactionPage,o.selectedWalletType,o.selectedWalletDate)),loading:o.loadingViewMore},{default:p(()=>[f(a(e.$t("View more")),1)]),_:1},8,["loading"])])):w("",!0)])],64)}const rs=T(ke,[["render",ss]]);export{rs as default};
