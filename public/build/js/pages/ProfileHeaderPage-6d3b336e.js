import{_ as I,a7 as F,U as M,dI as O,r as p,o,c as f,g as h,w as c,e as u,t as r,h as l,d,F as _,dJ as Q,j as J,m as $,du as A,ad as C,cf as K,aZ as W,b as i,br as Z,b0 as T,b1 as E,B as N,am as G,a8 as V,u as R,p as j,V as D,dK as X,W as Y,dL as x,f as H,Q as z,y as ee,l as L,I as B,bQ as se,dM as oe,S as te}from"../../assets/app-8df99815.js";import{M as re}from"./MessageButton-c186d8fa.js";import ae from"./ProfileUserMenu-43aba42c.js";import{S as ne}from"./StoryDetailModal-32bf749a.js";import{B as ie}from"./BaseUploadCover-49ec6ee3.js";import"./StoryDetail-ca434ce3.js";const le={components:{Error:F,UsersList:M},inject:{dialogRef:{default:null}},data(){return{error:null,loadmore_status:!1,loading_users:!0,followingUsersList:[],page:1}},mounted(){this.getFollowingUsersList(this.user.id,this.page)},computed:{user(){return this.dialogRef.data.user}},methods:{async getFollowingUsersList(e,s){try{const a=await O(e,s);s===1?this.followingUsersList=a.items:this.followingUsersList=window._.concat(this.followingUsersList,a.items),a.has_next_page?(this.loadmore_status=!0,this.page++):this.loadmore_status=!1,this.loading_users=!1}catch(a){this.error=a,this.loading_users=!1}}}};function ue(e,s,a,k,t,n){const m=p("Error"),w=p("UsersList");return o(),f(_,null,[t.error?(o(),h(m,{key:0},{default:c(()=>[u(r(t.error),1)]),_:1})):l("",!0),d(w,{loading:t.loading_users,usersList:t.followingUsersList,"has-load-more":t.loadmore_status,onLoadMore:s[0]||(s[0]=v=>n.getFollowingUsersList(n.user.id,t.page))},null,8,["loading","usersList","has-load-more"])],64)}const de=I(le,[["render",ue]]),fe={components:{Error:F,UsersList:M},inject:{dialogRef:{default:null}},data(){return{error:null,loadmore_status:!1,loading_users:!0,followerUsersList:[],page:1}},mounted(){this.getFollowerUsersList(this.user.id,this.page)},computed:{user(){return this.dialogRef.data.user}},methods:{async getFollowerUsersList(e,s){try{const a=await Q(e,s);s===1?this.followerUsersList=a.items:this.followerUsersList=window._.concat(this.followerUsersList,a.items),a.has_next_page?(this.loadmore_status=!0,this.page++):this.loadmore_status=!1,this.loading_users=!1}catch(a){this.error=a,this.loading_users=!1}}}};function pe(e,s,a,k,t,n){const m=p("Error"),w=p("UsersList");return o(),f(_,null,[t.error?(o(),h(m,{key:0},{default:c(()=>[u(r(t.error),1)]),_:1})):l("",!0),d(w,{loading:t.loading_users,usersList:t.followerUsersList,"has-load-more":t.loadmore_status,onLoadMore:s[0]||(s[0]=v=>n.getFollowerUsersList(n.user.id,t.page))},null,8,["loading","usersList","has-load-more"])],64)}const me=I(fe,[["render",pe]]),ce={components:{BaseIcon:J},computed:{...$(A,["userInfo"])},methods:{uploadAvatar(e){var s=e.target;if(s.files&&s.files[0]){var a=new FileReader;a.onload=k=>{const t=K(()=>W(()=>import("./UploadAvatarModal-6534132c.js"),["./UploadAvatarModal-6534132c.js","../../assets/app-8df99815.js","../../assets/app-0209511c.css","./style-a13dfc58.js","../../assets/style-790ea523.css"],import.meta.url));this.$dialog.open(t,{data:{imageData:k.target.result},props:{header:this.$t("Crop Avatar"),class:"crop-avatar-modal p-dialog-md",modal:!0},onClose:n=>{n.data&&(this.userInfo.avatar=n.data.avatar),C()}})},a.readAsDataURL(s.files[0])}},onInputClick(e){e.target.value=null}}};function he(e,s,a,k,t,n){const m=p("BaseIcon");return o(),f("button",{class:"inline-flex items-center gap-1 bg-gray-trans-4 text-white rounded-full p-1",onClick:s[2]||(s[2]=w=>e.$refs.avatar.click())},[d(m,{name:"camera"}),i("input",{type:"file",ref:"avatar",onChange:s[0]||(s[0]=w=>n.uploadAvatar(w)),onClick:s[1]||(s[1]=w=>n.onInputClick(w)),accept:"image/*",class:"hidden"},null,544)])}const ge=I(ce,[["render",he]]),we={components:{Skeleton:Z},props:{itemNumber:{type:Number,default:5}}},be={class:"bg-white rounded-none md:rounded-base-lg dark:bg-slate-800 mb-base-2"},_e={class:"block relative pb-[38.5%] overflow-hidden rounded-none md:rounded-t-base-lg"},ke={class:"absolute inset-0"},ye={class:"relative inline-block p-base-1 ms-4 -mt-20 md:-mt-28 rounded-full bg-white dark:bg-slate-800"},ve={class:"pt-2 px-4 pb-4"},Ie={class:"flex flex-wrap justify-between items-start gap-x-5 gap-y-1 mb-base-1"},$e={class:"flex flex-wrap items-center gap-2"};function Ue(e,s,a,k,t,n){const m=p("Skeleton");return o(),f("div",be,[i("div",_e,[i("div",ke,[d(m,{height:"100%",width:"100%",class:"rounded-none"})])]),i("div",ye,[d(m,{class:"!w-28 !h-28 md:!w-base-36 md:!h-base-36 rounded-full"})]),i("div",ve,[i("div",Ie,[i("div",null,[d(m,{width:"12rem",height:"1.25rem",class:"mb-base-2"}),d(m,{width:"8rem",height:"1rem",class:"mb-base-2"})]),i("div",$e,[d(m,{height:"2.375rem",width:"6rem"}),d(m,{height:"2.375rem",width:"6rem"}),d(m,{height:"2.375rem",width:"2.375rem"})])]),d(m,{width:"14rem",height:"1rem"})])])}const Pe=I(we,[["render",Ue]]),Ce={inject:{dialogRef:{default:null}},components:{Avatar:T,UserName:E,BaseButton:N,BaseInputNumber:G},data(){return{mentionChar:V.MENTION,user:this.dialogRef.data.user,tipPackages:[],selectedTipPackage:null,tipAmount:null}},computed:{...$(R,["config"])},watch:{tipAmount(e){this.selectedTipPackage&&e!==this.selectedTipPackage.amount&&(this.selectedTipPackage=null)}},mounted(){this.getTipPackages()},methods:{...j(D,["pingNotification"]),async getTipPackages(){try{this.tipPackages=await X()}catch(e){this.showError(e.error)}},handleSelectPackage(e){var s;if(((s=this.selectedTipPackage)==null?void 0:s.id)===e.id){this.selectedTipPackage=null,this.tipAmount=null;return}this.selectedTipPackage=e,this.tipAmount=e.amount},handleSendTip(){const e=this.$dialog.open(Y,{props:{header:this.$t("Enter Password"),class:"password-modal",modal:!0,dismissableMask:!0,draggable:!1},emits:{onConfirm:async s=>{var a;if(s.password)try{await x({package_id:(a=this.selectedTipPackage)==null?void 0:a.id,amount:this.tipAmount,user_id:this.user.id,password:s.password}),this.showSuccess(this.$t("Tip successful")),this.dialogRef.close(),this.pingNotification()}catch(k){this.showError(k.error)}finally{e.close()}}}})}}},Se={class:"flex flex-col md:flex-row md:items-center justify-center gap-x-10 gap-y-3 p-0 md:p-6"},Le={class:"text-center"},Be={class:"flex-1"},Fe={class:"text-main-color text-2xl font-extrabold dark:text-white text-center mb-5"},Me={key:0,class:"grid grid-cols-2 md:grid-cols-4 gap-base-2 md:gap-4 mb-5"},Ae=["onClick"],Te={class:"font-bold text-center mb-5"};function Ee(e,s,a,k,t,n){const m=p("Avatar"),w=p("UserName"),v=p("router-link"),P=p("BaseInputNumber"),g=p("BaseButton");return o(),f("div",Se,[i("div",Le,[d(m,{user:t.user,size:120,class:"mx-auto mb-base-2"},null,8,["user"]),d(w,{user:t.user,class:"text-xl justify-center"},null,8,["user"]),d(v,{to:{name:"profile",params:{user_name:t.user.user_name}}},{default:c(()=>[u(r(t.mentionChar+t.user.user_name),1)]),_:1},8,["to"])]),i("div",Be,[i("h3",Fe,[u(r(e.$t("Tip"))+" ",1),d(v,{to:{name:"profile",params:{user_name:t.user.user_name}}},{default:c(()=>[u(r(t.mentionChar+t.user.user_name),1)]),_:1},8,["to"]),u(" "+r((t.tipAmount||0)+" "+e.config.wallet.tokenName),1)]),t.tipPackages.length?(o(),f("div",Me,[(o(!0),f(_,null,H(t.tipPackages,y=>{var U;return o(),f("button",{key:y.id,class:z(["p-base-1 rounded-[100px] text-center",((U=t.selectedTipPackage)==null?void 0:U.id)===y.id?"bg-primary-color dark:bg-dark-primary-color":"bg-badge-color dark:bg-dark-web-wash"]),onClick:S=>n.handleSelectPackage(y)},r(y.amount),11,Ae)}),128))])):l("",!0),i("div",Te,r(e.$t("Enter amount")),1),d(P,{modelValue:t.tipAmount,"onUpdate:modelValue":s[0]||(s[0]=y=>t.tipAmount=y),class:"mb-5"},null,8,["modelValue"]),d(g,{onClick:n.handleSendTip,class:"w-full"},{default:c(()=>[u(r(e.$t("Send Tip")),1)]),_:1},8,["onClick"])])])}const Ne=I(Ce,[["render",Ee]]),Ve={components:{BaseButton:N,MessageButton:re,Avatar:T,UserName:E,BaseUploadCover:ie,BaseUploadAvatar:ge,SkeletonProfileHeader:Pe},props:["data","params","position"],data(){return{mentionChar:V.MENTION}},computed:{...$(R,["config","screen"]),...$(ee,["user","authenticated"]),...$(A,["userInfo"])},methods:{...j(D,["setSelectedPage"]),openProfileMenu(){this.$dialog.open(ae,{data:{userInfo:this.userInfo},props:{showHeader:!1,class:"dropdown-menu-modal",modal:!0,dismissableMask:!0,draggable:!1},onClose:()=>{C()}})},openFollowingModal(){this.$dialog.open(de,{data:{user:this.userInfo},props:{header:this.$t("Followings"),class:"follow-modal",modal:!0,dismissableMask:!0,draggable:!1}})},openFollowerModal(){this.$dialog.open(me,{data:{user:this.userInfo},props:{header:this.$t("Followers"),class:"follow-modal",modal:!0,dismissableMask:!0,draggable:!1}})},showStoryDetail(e){if(e>0){let s=this.$router.resolve({name:"story_view",params:{storyId:e}});L(s.fullPath),this.$dialog.open(ne,{data:{id:e,storiesList:[e]},props:{class:"p-dialog-story p-dialog-story-detail p-dialog-no-header-title",modal:!0,showHeader:!1,draggable:!1},onClose:()=>{L(this.$router.currentRoute.value.fullPath),C()}})}},async followUser(e){if(this.authenticated)try{await B({id:e,action:"follow"}),this.userInfo.is_followed=!0,this.updateFollowStatus({userId:e,status:"follow"})}catch(s){this.showError(s.error)}else this.showRequireLogin()},async unFollowUser(e){try{await B({id:e,action:"unfollow"}),this.userInfo.is_followed=!1,this.updateFollowStatus({userId:e,status:"unfollow"})}catch(s){this.showError(s.error)}},async handleClickSwitchPage(e,s){this.setSelectedPage(e),setTimeout(async()=>{try{if(await se(e.id),s){let a=this.$router.resolve({name:"advertisings"});window.location.href=window.siteConfig.siteUrl+a.fullPath}else window.location.reload()}catch(a){this.showError(a.error),this.setSelectedPage(null)}},1500)},clickVerify(){let e="user_verify.send_request";this.checkPermission(e)&&this.$router.push({name:"verify_profile"})},handleSubscribeUser(){this.$dialog.open(oe,{data:{user:this.userInfo},props:{showHeader:!1,modal:!0,dismissableMask:!0,draggable:!1}})},handleTipUser(){this.$dialog.open(Ne,{data:{user:this.userInfo},props:{showHeader:!1,modal:!0,dismissableMask:!0,draggable:!1,class:"tip-user-dialog"}})}}},Re={key:0,class:"header-profile bg-white rounded-none md:rounded-base-lg dark:bg-slate-800 mb-base-2"},je={class:"relative overflow-hidden rounded-none md:rounded-t-base-lg pb-[38.5%]"},De={class:"absolute inset-0 h-full"},He={class:"px-4 pb-4"},ze={class:"flex flex-wrap justify-between items-start gap-x-5 gap-y-1 mb-base-1"},qe={class:"flex-1 max-w-full whitespace-nowrap"},Oe={class:"header-profile-username text-base-sm text-sub-color dark:text-slate-400 truncate"},Qe={class:"flex flex-wrap items-center gap-2"},Je={key:0,class:"flex flex-wrap mb-1"},Ke={key:1,class:"header-profile-count text-base-sm mb-base-1"},We={key:2,class:"text-base-sm break-word"};function Ze(e,s,a,k,t,n){const m=p("BaseUploadCover"),w=p("Avatar"),v=p("BaseUploadAvatar"),P=p("UserName"),g=p("BaseButton"),y=p("MessageButton"),U=p("router-link"),S=p("SkeletonProfileHeader");return e.userInfo?(o(),f("div",Re,[i("div",je,[i("div",De,[i("div",{class:"bg-cover bg-center bg-no-repeat w-full h-full",style:te({backgroundImage:`url(${e.userInfo.cover})`})},null,4)]),e.authenticated&&e.user.id==e.userInfo.id?(o(),h(m,{key:0,class:"absolute top-base-2 end-base-2"})):l("",!0)]),i("div",{class:z(["relative inline-block p-base-1 ms-4 -mt-20 md:-mt-28 rounded-full",e.userInfo.story_id==0?"bg-white dark:bg-slate-800":"bg-gradient-story cursor-pointer"])},[d(w,{user:e.userInfo,size:e.screen.md?112:150,activePopover:!1,border:!1,router:!1,onClick:s[0]||(s[0]=b=>e.userInfo.story_id==0?"":n.showStoryDetail(e.userInfo.story_id))},null,8,["user","size"]),e.authenticated&&e.user.id==e.userInfo.id?(o(),h(v,{key:0,class:"absolute top-0 end-1 md:top-2 md:end-2"})):l("",!0)],2),i("div",He,[i("div",ze,[i("div",qe,[d(P,{user:e.userInfo,activePopover:!1,class:"header-profile-name text-base-lg font-extrabold"},null,8,["user"]),i("div",Oe,r(t.mentionChar+e.userInfo.user_name),1)]),i("div",Qe,[e.userInfo.canSubscriber?(o(),h(g,{key:0,icon:"check_circle",type:"outlined",onClick:n.handleSubscribeUser},{default:c(()=>[u(r(e.$t("Subscribe")),1)]),_:1},8,["onClick"])):l("",!0),e.userInfo.subscriber_subscription_id?(o(),h(g,{key:1,icon:"check_circle",type:"outlined",to:{name:"setting_subscription_detail",params:{id:e.userInfo.subscriber_subscription_id}}},{default:c(()=>[u(r(e.$t("Subscribed")),1)]),_:1},8,["to"])):l("",!0),e.userInfo.canTip?(o(),h(g,{key:2,icon:"coin",type:"outlined",onClick:n.handleTipUser},{default:c(()=>[u(r(e.$t("Tip")),1)]),_:1},8,["onClick"])):l("",!0),e.userInfo.is_page?(o(),f(_,{key:3},[e.userInfo.id===e.user.id?(o(),f(_,{key:0},[e.config.advertising.enable?(o(),h(g,{key:0,type:"outlined",to:{name:"advertisings"}},{default:c(()=>[u(r(e.$t("Advertise")),1)]),_:1})):l("",!0),e.config.user_page.featureEnable&&!e.userInfo.is_page_feature?(o(),h(g,{key:1,type:"outlined",to:{name:"user_pages_feature"}},{default:c(()=>[u(r(e.$t("Feature Page")),1)]),_:1})):l("",!0),d(g,{type:"outlined",to:{name:"user_pages_overview"}},{default:c(()=>[u(r(e.$t("Manage")),1)]),_:1})],64)):l("",!0),e.userInfo.is_page_admin&&e.config.advertising.enable?(o(),h(g,{key:1,type:"outlined",onClick:s[1]||(s[1]=b=>n.handleClickSwitchPage(e.userInfo,!0))},{default:c(()=>[u(r(e.$t("Advertise")),1)]),_:1})):l("",!0),e.userInfo.is_page_admin?(o(),h(g,{key:2,type:"outlined",onClick:s[2]||(s[2]=b=>n.handleClickSwitchPage(e.userInfo,!1))},{default:c(()=>[u(r(e.$t("Switch Page")),1)]),_:1})):l("",!0)],64)):l("",!0),e.user.id!==e.userInfo.id?(o(),f(_,{key:4},[e.userInfo.can_send_message||e.userInfo.chat_room_id?(o(),h(y,{key:0,user_id:e.userInfo.id},null,8,["user_id"])):l("",!0),e.userInfo.can_follow?(o(),f(_,{key:1},[e.userInfo.is_followed?(o(),h(g,{key:0,onClick:s[3]||(s[3]=b=>n.unFollowUser(e.userInfo.id)),type:"outlined"},{default:c(()=>[u(r(e.$t("Unfollow")),1)]),_:1})):(o(),h(g,{key:1,onClick:s[4]||(s[4]=b=>n.followUser(e.userInfo.id)),type:"outlined"},{default:c(()=>[u(r(e.$t("Follow")),1)]),_:1}))],64)):l("",!0),e.authenticated?(o(),h(g,{key:2,type:"outlined",icon:"more_horiz_outlined",onClick:s[5]||(s[5]=b=>n.openProfileMenu())})):l("",!0)],64)):(o(),f(_,{key:5},[!e.userInfo.is_verify&&e.config.userVerifyEnable?(o(),h(g,{key:0,type:"outlined",onClick:n.clickVerify},{default:c(()=>[u(r(e.userInfo.is_page?e.$t("Verify Page"):e.$t("Verify Profile")),1)]),_:1},8,["onClick"])):l("",!0),d(g,{type:"outlined",to:{name:"setting_index"}},{default:c(()=>[u(r(e.userInfo.is_page?e.$t("Edit Page"):e.$t("Edit Profile")),1)]),_:1})],64))])]),e.userInfo.categories&&e.userInfo.categories.length?(o(),f("div",Je,[(o(!0),f(_,null,H(e.userInfo.categories,(b,q)=>(o(),f("span",{key:b.id},[d(U,{to:{name:"user_pages",query:{category_id:b.id}}},{default:c(()=>[u(r(b.name),1)]),_:2},1032,["to"]),u(" "+r(q===e.userInfo.categories.length-1?"":"· "),1)]))),128))])):l("",!0),e.userInfo.check_private?l("",!0):(o(),f("div",Ke,[i("span",null,r(e.$filters.numberShortener(e.userInfo.post_count,e.$t("[number] Post"),e.$t("[number] Posts"))),1),e.userInfo.show_following?(o(),f(_,{key:0},[s[8]||(s[8]=u(" · ")),i("button",{onClick:s[6]||(s[6]=b=>n.openFollowingModal())},r(e.$filters.numberShortener(e.userInfo.following_count,e.$t("[number] Following"),e.$t("[number] Followings"))),1)],64)):l("",!0),e.userInfo.show_follower?(o(),f(_,{key:1},[s[9]||(s[9]=u(" · ")),i("button",{onClick:s[7]||(s[7]=b=>n.openFollowerModal())},r(e.$filters.numberShortener(e.userInfo.follower_count,e.$t("[number] Follower"),e.$t("[number] Followers"))),1)],64)):l("",!0)])),e.userInfo.check_privacy?(o(),f("div",We,r(e.userInfo.bio),1)):l("",!0)])])):(o(),h(S,{key:1}))}const os=I(Ve,[["render",Ze]]);export{os as default};
