import{_ as S,B as A,b0 as F,b1 as C,a8 as h,m as d,y as O,bK as m,u as B,e1 as U,p as E,I as b,r as c,o,c as i,aC as M,g as w,d as p,w as P,S as g,b as n,Q as x,t as u,h as a,e as f,F as v,bg as L,e2 as N}from"../../assets/app-8df99815.js";import{M as T}from"./MessageButton-c186d8fa.js";const Y={components:{BaseButton:A,MessageButton:T,Avatar:F,UserName:C},data(){return{mentionChar:h.MENTION,userData:window._.clone(this.userProps),isShown:!1,caretPosition:{top:null,right:null,bottom:null,left:null},hoverPopoverItemStatus:!1,hoverPopoverStatus:!1}},props:{userProps:{type:Object,default:null},activePopover:{type:Boolean,default:!0}},computed:{...d(O,["user","authenticated"]),...d(m,["userAction"]),...d(B,["isMobile","config"])},watch:{userAction(){this.userData.id===this.userAction.userId&&(this.userAction.status==="follow"?this.userData.is_followed=!0:this.userAction.status==="unfollow"&&(this.userData.is_followed=!1))},async isShown(){if(this.isShown){const e=await U(this.userData.user_name);this.userData=e}}},methods:{...E(m,["updateFollowStatus"]),async followUser(e){if(this.authenticated)try{await b({id:e,action:"follow"}),this.userData.check_privacy=!0,this.userData.chat_privacy==h.CHAT_PRIVACY_FOLLOWER&&(this.userData.can_send_message=!0),this.updateFollowStatus({userId:e,status:"follow"})}catch(t){this.showError(t.error)}else this.showRequireLogin()},async unFollowUser(e){try{await b({id:e,action:"unfollow"}),this.userData.privacy==h.USER_PRIVACY_FOLLOWER&&(this.userData.check_privacy=!1),this.userData.chat_privacy==h.CHAT_PRIVACY_FOLLOWER&&(this.userData.can_send_message=!1),this.updateFollowStatus({userId:e,status:"unfollow"})}catch(t){this.showError(t.error)}},hoverPopoverItem(){this.activePopover&&(this.hoverPopoverItemStatus=!0,setTimeout(()=>{this.hoverPopoverItemStatus&&(this.updateCaretPosition(),this.isShown=!this.isShown)},1400))},leavePopoverItem(){this.activePopover&&(this.hoverPopoverItemStatus=!1,setTimeout(()=>{this.hoverPopoverStatus||this.isShown&&(this.isShown=!1)},400))},hoverPopover(){this.activePopover&&(this.hoverPopoverStatus=!0)},leavePopover(){this.activePopover&&(this.hoverPopoverStatus=!1,this.isShown&&(this.isShown=!1))},updateCaretPosition(){var t;const e=(t=this.$refs.popover_item)==null?void 0:t.getBoundingClientRect();this.user.rtl?(e==null?void 0:e.right)>320?this.caretPosition.right=window.innerWidth-(e==null?void 0:e.right):this.caretPosition.left=e==null?void 0:e.left:window.innerWidth-(e==null?void 0:e.left)>320?this.caretPosition.left=e==null?void 0:e.left:this.caretPosition.right=window.innerWidth-(e==null?void 0:e.right),window.innerHeight-(e==null?void 0:e.top)>290?this.caretPosition.top=(e==null?void 0:e.top)+(window.pageYOffset?window.pageYOffset:0)+(e==null?void 0:e.height):this.caretPosition.bottom=window.innerHeight-(window.pageYOffset?window.pageYOffset:0)-(e==null?void 0:e.top)+10},isPrivacyFollower(e){return e==h.USER_PRIVACY_FOLLOWER},isPrivacyOnlyme(e){return e==h.USER_PRIVACY_ONLYME}}},V={class:"header-profile bg-white dark:bg-slate-800 dark:text-white shadow-popover rounded-base dark:shadow-dark-popover"},W={class:"relative overflow-hidden rounded-none md:rounded-t-base pb-[38.5%]"},z={class:"absolute inset-0 h-full"},H={class:"px-base-2 pb-base-2"},j={class:"flex justify-between items-start gap-5"},I={class:"w-full"},q={class:"header-profile-username text-base-sm text-sub-color mb-1 dark:text-slate-400 break-word"},K={key:0,class:"header-profile-count text-base-sm mb-base-1"},Q={key:0,class:"inline-block"},G={key:1},J={key:2,class:"inline-block"},X={key:0,class:"text-base-sm mb-2"},Z={key:1,class:"flex gap-base-2 w-full"};function R(e,t,$,ee,s,r){const y=c("Avatar"),D=c("UserName"),k=c("MessageButton"),_=c("BaseButton");return o(),i("div",{ref:"popover_item",onMouseenter:t[4]||(t[4]=(...l)=>r.hoverPopoverItem&&r.hoverPopoverItem(...l)),onMouseleave:t[5]||(t[5]=(...l)=>r.leavePopoverItem&&r.leavePopoverItem(...l))},[M(e.$slots,"default"),(o(),w(N,{to:"body"},[p(L,{name:"fade"},{default:P(()=>[s.isShown&&!e.isMobile?(o(),i("div",{key:0,class:"absolute max-w-xs w-full z-[1199]",ref:"popover",onMouseenter:t[2]||(t[2]=(...l)=>r.hoverPopover&&r.hoverPopover(...l)),onMouseleave:t[3]||(t[3]=(...l)=>r.leavePopover&&r.leavePopover(...l)),style:g(s.caretPosition?{top:`${s.caretPosition.top?s.caretPosition.top+"px":""}`,right:`${s.caretPosition.right?s.caretPosition.right+"px":""}`,bottom:`${s.caretPosition.bottom?s.caretPosition.bottom+"px":""}`,left:`${s.caretPosition.left?s.caretPosition.left+"px":""}`}:{})},[n("div",V,[n("div",W,[n("div",z,[n("div",{class:"bg-cover bg-center bg-no-repeat w-full h-full",style:g({backgroundImage:`url(${s.userData.cover})`})},null,4)])]),n("div",{class:x(["relative inline-block ms-base-2 -mt-14 p-1 rounded-full",!s.userData.story_id||!e.authenticated?"bg-white dark:bg-slate-800":"bg-gradient-story cursor-pointer"])},[p(y,{user:s.userData,size:80,border:!1,"active-popover":!1},null,8,["user"])],2),n("div",H,[n("div",j,[n("div",I,[p(D,{user:s.userData,"active-popover":!1,class:"text-base-lg"},null,8,["user"]),n("div",q,u(s.mentionChar+s.userData.user_name),1),s.userData.check_privacy?(o(),i("div",K,[s.userData.show_following?(o(),i("span",Q,u(e.$filters.numberShortener(s.userData.following_count,e.$t("[number] Following"),e.$t("[number] Followings"))),1)):a("",!0),t[6]||(t[6]=f()),s.userData.show_following&&s.userData.show_follower?(o(),i("span",G,"Â·")):a("",!0),t[7]||(t[7]=f()),s.userData.show_follower?(o(),i("span",J,u(e.$filters.numberShortener(s.userData.follower_count,e.$t("[number] Follower"),e.$t("[number] Followers"))),1)):a("",!0)])):a("",!0)])]),s.userData.privacy?(o(),i(v,{key:0},[s.userData.check_privacy?a("",!0):(o(),i("div",X,[r.isPrivacyFollower(s.userData.privacy)?(o(),i(v,{key:0},[f(u(e.$t("This Account is Private. Follow to see their posts")),1)],64)):a("",!0),r.isPrivacyOnlyme(s.userData.privacy)?(o(),i(v,{key:1},[f(u(e.$t("This Account is Private")),1)],64)):a("",!0)]))],64)):a("",!0),s.userData.privacy&&e.user.id!==s.userData.id?(o(),i("div",Z,[s.userData.can_send_message||s.userData.chat_room_id?(o(),w(k,{key:0,user_id:s.userData.id,class:"flex-1"},null,8,["user_id"])):a("",!0),s.userData.can_follow?(o(),i(v,{key:1},[s.userData.is_followed?(o(),w(_,{key:0,onClick:t[0]||(t[0]=l=>r.unFollowUser(s.userData.id)),type:"outlined",class:"flex-1"},{default:P(()=>[f(u(e.$t("Unfollow")),1)]),_:1})):(o(),w(_,{key:1,onClick:t[1]||(t[1]=l=>r.followUser(s.userData.id)),type:"outlined",class:"flex-1"},{default:P(()=>[f(u(e.$t("Follow")),1)]),_:1}))],64)):a("",!0)])):a("",!0)])])],36)):a("",!0)]),_:1})]))],544)}const oe=S(Y,[["render",R]]);export{oe as default};
