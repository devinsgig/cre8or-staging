import{_ as L,s as B,a as V,B as D,ao as S,an as C,aN as k,aS as x,aT as _,aU as M,r as a,o as U,c as v,b as d,$ as T,d as r,w as l,e as h,t as p,F as G}from"../../assets/app-8df99815.js";import{P as A}from"./PendingPostsList-701fede9.js";import{B as I}from"./BaseCalendar-e4a0da98.js";import"./SkeletonPostsList-68921a0e.js";import"./index.esm-3350796f.js";const N={props:["adminConfig"],components:{BaseInputText:B,BaseSelect:V,PendingPostsList:A,BaseButton:D,BaseCalendar:I,AutoSuggestUserItem:S,BaseSuggest:C},data(){return{selectedUser:"",keyword:"",fromDate:"",toDate:"",type:"",typesList:[],sort:"last",currentPage:1,loadingPendingPosts:!0,pendingPostsList:[],currentMemberPage:1,membersList:[]}},computed:{sortsList(){return[{value:"last",name:this.$t("Newest first")},{value:"first",name:this.$t("Oldest first")}]},userId(){return this.selectedUser.length?this.selectedUser[0].user.id:""}},mounted(){this.handleGetPendingPosts(this.adminConfig.group.id,this.userId,this.keyword,this.currentPage,this.formatDateTime(this.fromDate),this.formatDateTime(this.toDate),this.type,this.sort),this.typesList=Object.entries(this.adminConfig.postTypes).map(([t,e])=>({value:t,name:e}))},methods:{async handleGetGroupMember(t){try{const e=await k(this.adminConfig.group.id,t.query,this.currentMemberPage);this.currentMemberPage==1&&(this.membersList=[]),this.membersList=window._.concat(this.membersList,e.items),e.has_next_page&&this.currentMemberPage++}catch(e){this.showError(e.error)}},async handleGetPendingPosts(t,e,f,u,s,n,c,m){try{const i=await x(t,e,f,u,s,n,c,m);return u==1&&(this.pendingPostsList=[]),this.pendingPostsList=window._.concat(this.pendingPostsList,i.items),i}catch(i){this.showError(i.error)}finally{this.loadingPendingPosts=!1}},loadMorePosts(t){this.handleGetPendingPosts(this.adminConfig.group.id,this.userId,this.keyword,++this.currentPage,this.formatDateTime(this.fromDate),this.formatDateTime(this.toDate),this.type,this.sort).then(e=>{e.items.length===0?t.complete():t.loaded()})},handleRejectPost(t){this.$confirm.require({message:this.$t("Are you sure you want to reject this pending post?"),header:this.$t("Please confirm"),acceptLabel:this.$t("Ok"),rejectLabel:this.$t("Cancel"),accept:async()=>{try{await _(t),this.pendingPostsList=this.pendingPostsList.filter(e=>e.id!==t),this.$emit("updated")}catch(e){this.showError(e.error)}}})},async handleAcceptPost(t){try{await M(t),this.pendingPostsList=this.pendingPostsList.filter(e=>e.id!==t),this.$emit("updated")}catch(e){this.showError(e.error)}},handleSearchPendingPosts(){this.currentPage=1,this.handleGetPendingPosts(this.adminConfig.group.id,this.userId,this.keyword,this.currentPage,this.formatDateTime(this.fromDate),this.formatDateTime(this.toDate),this.type,this.sort)}},emits:["updated"]},j={class:"bg-white border border-white text-main-color p-base-2 md:p-4 mb-base-2 rounded-none md:rounded-base-lg dark:bg-slate-800 dark:border-slate-800 dark:text-white"},E={class:"flex flex-wrap items-center gap-base-2"},O={class:"flex flex-wrap gap-base-2"},R={class:"flex gap-base-2"};function q(t,e,f,u,s,n){const c=a("BaseInputText"),m=a("BaseSelect"),i=a("AutoSuggestUserItem"),y=a("BaseSuggest"),P=a("BaseCalendar"),g=a("BaseButton"),b=a("PendingPostsList");return U(),v(G,null,[d("div",j,[d("form",{onSubmit:e[6]||(e[6]=T((...o)=>n.handleSearchPendingPosts&&n.handleSearchPendingPosts(...o),["prevent"])),class:"flex flex-col gap-base-2"},[d("div",E,[r(c,{modelValue:s.keyword,"onUpdate:modelValue":e[0]||(e[0]=o=>s.keyword=o),placeholder:t.$t("Keyword"),class:"md:flex-3"},null,8,["modelValue","placeholder"]),r(m,{modelValue:s.sort,"onUpdate:modelValue":e[1]||(e[1]=o=>s.sort=o),options:n.sortsList,optionLabel:"name",optionValue:"value",class:"md:flex-1"},null,8,["modelValue","options"])]),d("div",O,[r(y,{modelValue:s.selectedUser,"onUpdate:modelValue":e[2]||(e[2]=o=>s.selectedUser=o),suggestions:s.membersList,optionLabel:"user.name",onComplete:n.handleGetGroupMember,placeholder:t.$t("Author"),emptySearchMessage:t.$t("No users found"),class:"md:w-max"},{option:l(({option:o})=>[r(i,{user:o.user},null,8,["user"])]),_:1},8,["modelValue","suggestions","onComplete","placeholder","emptySearchMessage"]),r(P,{modelValue:s.fromDate,"onUpdate:modelValue":e[3]||(e[3]=o=>s.fromDate=o),placeholder:t.$t("Start Date"),class:"md:flex-1",showButtonBar:""},null,8,["modelValue","placeholder"]),r(P,{modelValue:s.toDate,"onUpdate:modelValue":e[4]||(e[4]=o=>s.toDate=o),placeholder:t.$t("End Date"),class:"md:flex-1",showButtonBar:""},null,8,["modelValue","placeholder"]),r(m,{modelValue:s.type,"onUpdate:modelValue":e[5]||(e[5]=o=>s.type=o),options:s.typesList,placeholder:t.$t("All content type"),optionLabel:"name",optionValue:"value",class:"md:flex-1"},null,8,["modelValue","options","placeholder"])]),r(g,null,{default:l(()=>[h(p(t.$t("Search")),1)]),_:1})],32)]),r(b,{loading:s.loadingPendingPosts,"posts-list":s.pendingPostsList,onLoadMore:n.loadMorePosts},{actions:l(({item:o})=>[d("div",R,[r(g,{onClick:w=>n.handleAcceptPost(o.id),class:"flex-1"},{default:l(()=>[h(p(t.$t("Accept")),1)]),_:2},1032,["onClick"]),r(g,{onClick:w=>n.handleRejectPost(o.id),class:"flex-1",type:"danger"},{default:l(()=>[h(p(t.$t("Reject")),1)]),_:2},1032,["onClick"])])]),empty:l(()=>[h(p(t.$t("No pending posts")),1)]),_:1},8,["loading","posts-list","onLoadMore"])],64)}const J=L(N,[["render",q]]);export{J as default};
